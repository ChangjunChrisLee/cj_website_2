<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>통계적 추론 – CJL &amp; Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">CJL &amp; Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Courses</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-courses">    
        <li>
    <a class="dropdown-item" href="../../../../teaching/index.html">
 <span class="dropdown-text">All Courses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../teaching/ml101/index.html">
 <span class="dropdown-text">ML101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../teaching/grad_stat/index.html">
 <span class="dropdown-text">STAT101</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../proj/index.html"> 
<span class="menu-text">Proj</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blogs/index.html"> 
<span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://ctcl.netlify.app"> 
<span class="menu-text">LAB</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link active" data-scroll-target="#statistical-inference">Statistical Inference</a>
  <ul class="collapse">
  <li><a href="#introduction-to-statistical-inference" id="toc-introduction-to-statistical-inference" class="nav-link" data-scroll-target="#introduction-to-statistical-inference">1. Introduction to Statistical Inference</a></li>
  <li><a href="#point-estimation" id="toc-point-estimation" class="nav-link" data-scroll-target="#point-estimation">2. Point Estimation</a></li>
  <li><a href="#interval-estimation-confidence-intervals" id="toc-interval-estimation-confidence-intervals" class="nav-link" data-scroll-target="#interval-estimation-confidence-intervals">3. Interval Estimation (Confidence Intervals)</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">4. Hypothesis Testing</a></li>
  <li><a href="#types-of-errors" id="toc-types-of-errors" class="nav-link" data-scroll-target="#types-of-errors">5. Types of Errors</a></li>
  </ul></li>
  <li><a href="#frequentist-vs.-bayesian" id="toc-frequentist-vs.-bayesian" class="nav-link" data-scroll-target="#frequentist-vs.-bayesian">Frequentist vs.&nbsp;Bayesian</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#historical-background" id="toc-historical-background" class="nav-link" data-scroll-target="#historical-background">2. Historical Background</a></li>
  <li><a href="#philosophical-differences" id="toc-philosophical-differences" class="nav-link" data-scroll-target="#philosophical-differences">3. Philosophical Differences</a></li>
  <li><a href="#bayes-theorem" id="toc-bayes-theorem" class="nav-link" data-scroll-target="#bayes-theorem">4. Bayes’ Theorem</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example:</a></li>
  <li><a href="#intuitive-examples" id="toc-intuitive-examples" class="nav-link" data-scroll-target="#intuitive-examples">5. Intuitive Examples</a></li>
  <li><a href="#example-2-hypothesis-testing-frequentist-vs.-bayesian" id="toc-example-2-hypothesis-testing-frequentist-vs.-bayesian" class="nav-link" data-scroll-target="#example-2-hypothesis-testing-frequentist-vs.-bayesian">6. Example 2: Hypothesis Testing (Frequentist vs.&nbsp;Bayesian)</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">7. Key Takeaways</a></li>
  </ul></li>
  <li><a href="#anova-analysis-of-variance" id="toc-anova-analysis-of-variance" class="nav-link" data-scroll-target="#anova-analysis-of-variance">ANOVA (Analysis of Variance)</a>
  <ul class="collapse">
  <li><a href="#anova의-기본-개념" id="toc-anova의-기본-개념" class="nav-link" data-scroll-target="#anova의-기본-개념">ANOVA의 기본 개념</a></li>
  <li><a href="#anova의-원리" id="toc-anova의-원리" class="nav-link" data-scroll-target="#anova의-원리">ANOVA의 원리</a></li>
  <li><a href="#anova의-f-통계량" id="toc-anova의-f-통계량" class="nav-link" data-scroll-target="#anova의-f-통계량">ANOVA의 F-통계량</a></li>
  <li><a href="#anova의-해석" id="toc-anova의-해석" class="nav-link" data-scroll-target="#anova의-해석">ANOVA의 해석</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#anova의-확장" id="toc-anova의-확장" class="nav-link" data-scroll-target="#anova의-확장">ANOVA의 확장</a></li>
  <li><a href="#anova의-주요-응용-분야" id="toc-anova의-주요-응용-분야" class="nav-link" data-scroll-target="#anova의-주요-응용-분야">ANOVA의 주요 응용 분야</a></li>
  <li><a href="#anova의-한계" id="toc-anova의-한계" class="nav-link" data-scroll-target="#anova의-한계">ANOVA의 한계</a></li>
  <li><a href="#anova에서-t-분포-시각화-및-t-값-p-값-계산" id="toc-anova에서-t-분포-시각화-및-t-값-p-값-계산" class="nav-link" data-scroll-target="#anova에서-t-분포-시각화-및-t-값-p-값-계산">ANOVA에서 t-분포 시각화 및 t-값, p-값 계산</a></li>
  </ul></li>
  <li><a href="#experimental-design" id="toc-experimental-design" class="nav-link" data-scroll-target="#experimental-design">Experimental Design</a>
  <ul class="collapse">
  <li><a href="#x2-factorial-design" id="toc-x2-factorial-design" class="nav-link" data-scroll-target="#x2-factorial-design">2x2 Factorial Design</a></li>
  <li><a href="#main-effects-and-interaction-effects" id="toc-main-effects-and-interaction-effects" class="nav-link" data-scroll-target="#main-effects-and-interaction-effects">Main Effects and Interaction Effects</a></li>
  <li><a href="#between-subjects-vs.-within-subjects-designs" id="toc-between-subjects-vs.-within-subjects-designs" class="nav-link" data-scroll-target="#between-subjects-vs.-within-subjects-designs">Between-Subjects vs.&nbsp;Within-Subjects Designs</a></li>
  <li><a href="#mixed-factorial-design" id="toc-mixed-factorial-design" class="nav-link" data-scroll-target="#mixed-factorial-design">Mixed Factorial Design</a></li>
  <li><a href="#언제-어떤-방법을-사용할까" id="toc-언제-어떤-방법을-사용할까" class="nav-link" data-scroll-target="#언제-어떤-방법을-사용할까">언제 어떤 방법을 사용할까?</a></li>
  </ul></li>
  <li><a href="#마치며" id="toc-마치며" class="nav-link" data-scroll-target="#마치며">마치며</a>
  <ul class="collapse">
  <li><a href="#실험-설계-무작위-대조-실험randomized-controlled-experiment" id="toc-실험-설계-무작위-대조-실험randomized-controlled-experiment" class="nav-link" data-scroll-target="#실험-설계-무작위-대조-실험randomized-controlled-experiment">실험 설계: 무작위 대조 실험(Randomized Controlled Experiment)</a></li>
  <li><a href="#실험-결과와-통계적-해석" id="toc-실험-결과와-통계적-해석" class="nav-link" data-scroll-target="#실험-결과와-통계적-해석">실험 결과와 통계적 해석</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">통계적 추론</h1>
<p class="subtitle lead">추론 통계, ANOVA, 실험 디자인</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://changjunlee.com/teaching/grad_stat/weekly_2/">Weekly content</a></p>
<p><br></p>
<section id="statistical-inference" class="level2">
<h2 class="anchored" data-anchor-id="statistical-inference">Statistical Inference</h2>
<blockquote class="blockquote">
<p><strong>‘제 2차 세계대전의 손상된 전투기’ 사례</strong></p>
<p>당시 연합군은 전투기가 격추되는 것을 줄이기 위해 손상된 전투기들의 데이터를 분석했습니다. 대부분의 전투기는 날개와 꼬리에 총탄이 많이 맞은 상태로 돌아왔고, 연구팀은 이 부위에 장갑을 강화해야 한다고 생각했죠. 그런데 통계학자 아브라함 발드(Abraham Wald)는 발상을 뒤집었습니다. 살아 돌아온 전투기들은 총알을 맞아도 생존할 수 있었던 부위에 손상을 입었다는 점을 지적하며, <strong>격추된 전투기들은 아마도 다른 부위가 손상되어 돌아오지 못했을 가능성이 크다고 했습니다.</strong> 그래서 결론적으로 장갑은 덜 손상된 부위에 덧대어야 한다고 주장했죠. 이 분석은 전투기의 생존률을 크게 높였다고 알려져 있습니다.</p>
</blockquote>
<ul>
<li><strong>통계적 추론:</strong> 표본(Sample) 데이터를 통해 모집단(Population)의 특성을 추정하고 이해하는 과정</li>
</ul>
<p><br></p>
<section id="introduction-to-statistical-inference" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-statistical-inference">1. Introduction to Statistical Inference</h3>
<p><strong>Statistical Inference</strong> is <u>the process of drawing conclusions about population parameters based on a sample from the population</u>. There are two main branches of statistical inference:</p>
<ul>
<li><p><strong>Estimation</strong>: Involves estimating population parameters (e.g., the mean or variance) using sample data.</p></li>
<li><p><strong>Hypothesis Testing</strong>: Involves testing assumptions (hypotheses) about population parameters.</p></li>
</ul>
<p>In other words, (in Korean)</p>
<ul>
<li><p><strong>Estimation (추정):</strong> 표본 데이터를 사용하여 모집단의 특정 <strong>모수(예: 평균, 분산 등)</strong>를 <strong>알아내고 추정</strong>하는 데 목적이 있음. 주된 목표는 모집단의 실제 모수 값을 가능한 정확히 <strong>근사</strong>하는 것. 예를 들어, 모집단의 평균을 추정하기 위해 표본의 평균을 사용.</p></li>
<li><p><strong>Hypothesis Testing (가설 검정):</strong> 모집단의 모수에 대한 특정한 <strong>주장이 참인지 판단</strong>하는 데 목적이 있음. 예를 들어, 모집단 평균이 특정 값(예: 50)인지 아닌지를 확인하고자 할 때, 귀무 가설과 대립 가설을 세워 이를 테스트.</p></li>
</ul>
<p>The objective is to make reliable conclusions about a population, recognizing that sample data inherently contains some uncertainty.</p>
<p><br></p>
</section>
<section id="point-estimation" class="level3">
<h3 class="anchored" data-anchor-id="point-estimation">2. Point Estimation</h3>
<p>A <strong>point estimate</strong> provides a single value as an estimate of a population parameter. The most common point estimators are:</p>
<ul>
<li><p>Sample Mean (<span class="math inline">\(\hat{\mu}\)</span>): An estimate of the population mean (<span class="math inline">\(\mu\)</span>).</p></li>
<li><p>Sample Variance (<span class="math inline">\(\hat{\sigma}\)</span>): An estimate of the population variance (<span class="math inline">\(\sigma^2\)</span>).</p></li>
</ul>
<section id="equations" class="level4">
<h4 class="anchored" data-anchor-id="equations">Equations:</h4>
<ul>
<li>The <strong>sample mean</strong> <span class="math inline">\(\hat{\mu}\)</span> is given by:</li>
</ul>
<p><span class="math display">\[
\mu = \frac{1}{n} \sum_{i=1}^n X_i
\]</span></p>
<ul>
<li>The <strong>sample variance</strong> <span class="math inline">\(\hat{\sigma}\)</span> is given by:</li>
</ul>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \hat{\mu})^2
\]</span></p>
</section>
<section id="properties-of-good-estimators" class="level4">
<h4 class="anchored" data-anchor-id="properties-of-good-estimators">Properties of Good Estimators:</h4>
<ul>
<li><p><strong>Unbiasedness</strong>: The expected value of the estimator is equal to the parameter it estimates.</p></li>
<li><p><strong>Consistency</strong>: As the sample size increases, the estimator converges to the true parameter.</p></li>
<li><p><strong>Efficiency</strong>: Among unbiased estimators, an efficient estimator has the smallest variance.</p></li>
</ul>
<p><img src="https://www.researchgate.net/publication/350710941/figure/fig1/AS:1010121870163978@1617843229779/Regression-model-properties-Accuracy-consistency-efficiency-and-bias-of-estimator.ppm" class="img-fluid"></p>
<p>Source: <a href="https://www.researchgate.net/figure/Regression-model-properties-Accuracy-consistency-efficiency-and-bias-of-estimator_fig1_350710941" class="uri">https://www.researchgate.net/figure/Regression-model-properties-Accuracy-consistency-efficiency-and-bias-of-estimator_fig1_350710941</a></p>
<p><br></p>
<p><img src="images/clipboard-4238882567.png" class="img-fluid"></p>
<p>Source: <a href="http://www.gtmath.com/2018/04/parameter-estimation-part-1-reader.html" class="uri">http://www.gtmath.com/2018/04/parameter-estimation-part-1-reader.html</a></p>
<p><br></p>
</section>
<section id="r-code-for-point-estimation" class="level4">
<h4 class="anchored" data-anchor-id="r-code-for-point-estimation">R Code for Point Estimation:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random sample data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate point estimates</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sample_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(data)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Mean:"</span>, sample_mean, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Mean: 50.90406 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Variance:"</span>, sample_variance, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Variance: 83.32328 </code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="interval-estimation-confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="interval-estimation-confidence-intervals">3. Interval Estimation (Confidence Intervals)</h3>
<p>A <strong>confidence interval</strong> provides a range of values that is likely to contain the population parameter with a specified level of confidence (e.g., 95%).</p>
<p>For the sample mean, a <strong>95% confidence interval</strong> can be calculated as:</p>
<p><span class="math display">\[
CI = \hat{\mu} \pm z_{\alpha/2} \cdot \frac{\hat{\sigma}}{\sqrt{n}}
\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(\hat{\mu}\)</span> is the sample mean,</p></li>
<li><p><span class="math inline">\(z_{\alpha/2}\)</span> is the critical value (임계값) from the standard normal distribution (1.96 for 95% confidence),</p>
<ul>
<li><span class="math inline">\(z_{\alpha/2}\)</span>​는 표준 정규 분포에서 특정 신뢰 수준(예: 95%, 99%)을 반영하는 값으로, 예를 들어, 95% 신뢰 구간을 구할 때는 <span class="math inline">\(\alpha = 0.05\)</span>이며, <span class="math inline">\(z_{0.025}\)</span>​는 약 1.96.</li>
</ul>
<!-- -->
<ul>
<li>신뢰 구간이 얼마나 넓어질지 결정하는 요소</li>
</ul></li>
<li><p><span class="math inline">\(\hat{\sigma}\)</span> is the sample standard deviation,</p></li>
<li><p><span class="math inline">\(n\)</span> is the sample size.</p>
<ul>
<li><strong>표준 오차</strong>는 표본 크기가 커질수록 작아지며, 이는 표본 평균이 모집단 평균에 더 근접함을 의미.</li>
</ul></li>
</ul>
<p><br></p>
<section id="r-code-for-confidence-interval" class="level4">
<h4 class="anchored" data-anchor-id="r-code-for-confidence-interval">R Code for Confidence Interval:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate a 95% confidence interval</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>confidence_interval <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(data)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  error <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  lower_bound <span class="ot">&lt;-</span> mean <span class="sc">-</span> error</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  upper_bound <span class="ot">&lt;-</span> mean <span class="sc">+</span> error</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(lower_bound, upper_bound))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the 95% confidence interval</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">confidence_interval</span>(data)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Interval:"</span>, ci, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Interval: 49.11497 52.69315 </code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing">4. Hypothesis Testing</h3>
<p><strong>Hypothesis Testing</strong> involves testing an assumption (hypothesis) about a population parameter. The two types of hypotheses are:</p>
<ul>
<li><p><strong>Null Hypothesis (H₀)</strong>: The statement being tested, usually a statement of no effect or no difference.</p></li>
<li><p><strong>Alternative Hypothesis (H₁)</strong>: The statement you want to test, indicating an effect or difference.</p></li>
</ul>
<section id="steps-in-hypothesis-testing" class="level4">
<h4 class="anchored" data-anchor-id="steps-in-hypothesis-testing">Steps in Hypothesis Testing:</h4>
<ol type="1">
<li><p>State the null and alternative hypotheses.</p></li>
<li><p>Choose a significance level (<span class="math inline">\(\alpha\)</span>, usually 0.05).</p></li>
<li><p>Compute a test statistic.</p></li>
<li><p>Determine the critical value or p-value.</p></li>
<li><p>Make a decision: reject or fail to reject the null hypothesis.</p></li>
</ol>
</section>
<section id="test-statistic-for-a-mean" class="level4">
<h4 class="anchored" data-anchor-id="test-statistic-for-a-mean">Test Statistic for a Mean:</h4>
<p>For large samples (n &gt; 30), we use the z-statistic:</p>
<p><span class="math display">\[
Z = \frac{\hat{\mu} - \mu_0}{\hat{\sigma} / \sqrt{n}}
\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(\hat{\mu}\)</span> is the sample mean,</p></li>
<li><p><span class="math inline">\(\mu_0\)</span> is the population mean under the null hypothesis,</p></li>
<li><p><span class="math inline">\(\hat{\sigma}\)</span> is the sample standard deviation.</p></li>
</ul>
</section>
<section id="r-code-for-hypothesis-testing-one-sample-t-test" class="level4">
<h4 class="anchored" data-anchor-id="r-code-for-hypothesis-testing-one-sample-t-test">R Code for Hypothesis Testing (One-Sample t-test):</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">75</span>, <span class="dv">80</span>, <span class="dv">77</span>, <span class="dv">73</span>, <span class="dv">70</span>, <span class="dv">74</span>, <span class="dv">85</span>, <span class="dv">79</span>)  <span class="co"># Replace with your data</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesized population mean</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mu_0 <span class="ot">&lt;-</span> <span class="dv">75</span>  <span class="co"># Hypothesized mean to test against</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the one-sample t-test</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(scores, <span class="at">mu =</span> mu_0)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View the result</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  scores
t = 1.6259, df = 9, p-value = 0.1384
alternative hypothesis: true mean is not equal to 75
95 percent confidence interval:
 74.09994 80.50006
sample estimates:
mean of x 
     77.3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the sample distribution with a histogram</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(scores, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Sample Scores Distribution with Hypothesized Mean"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Scores"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"skyblue"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">"white"</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a line for the sample mean</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(scores), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">mean</span>(scores), <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>], <span class="at">labels =</span> <span class="st">"Sample Mean"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a line for the hypothesized mean</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> mu_0, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(mu_0, <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>], <span class="at">labels =</span> <span class="st">"Hypothesized Mean"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add confidence interval lines</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>conf.int</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ci[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(ci[<span class="dv">1</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>], <span class="at">labels =</span> <span class="st">"95% CI Lower"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(ci[<span class="dv">2</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>], <span class="at">labels =</span> <span class="st">"95% CI Upper"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="09_week_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="types-of-errors" class="level3">
<h3 class="anchored" data-anchor-id="types-of-errors">5. Types of Errors</h3>
<p>In hypothesis testing, we can make two types of errors:</p>
<p><img src="images/clipboard-1343055752.png" class="img-fluid"></p>
<ul>
<li><p><strong>Type I Error</strong>: Rejecting the null hypothesis when it is true (false positive).</p></li>
<li><p><strong>Type II Error</strong>: Failing to reject the null hypothesis when it is false (false negative).</p></li>
</ul>
<p>The <strong>power</strong> of a test is the probability of correctly rejecting a false null hypothesis (1 - probability of Type II error).</p>
<p><strong>검정력(Power of a Test)</strong>은 <strong>잘못된 귀무 가설을 정확하게 기각할 확률</strong>. 즉, <strong>귀무 가설이 실제로 틀렸을 때, 이를 제대로 알아채고 기각할 가능성</strong>을 나타내는 지표.</p>
<ul>
<li><p>검정력은 수식으로 <strong>1 - 제2종 오류의 확률</strong></p>
<ul>
<li><p><strong>제2종 오류</strong>는 귀무 가설이 틀렸음에도 불구하고 이를 기각하지 못하는 실수</p></li>
<li><p>따라서 <strong>검정력</strong>은 제2종 오류를 피하고, 잘못된 가설을 제대로 기각할 확률</p></li>
<li><p>ML 성능 측정 지표의 Recall (Sensitivity 민감도, 또는 재현율)과 같음.</p>
<ul>
<li><p>참인 값을 놓치지 않는 능력</p></li>
<li><p>실제로 양성인 모든 데이터 중에서 모델이 양성이라고 정확히 예측한 비율</p></li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
<section id="r-code-for-power-calculation" class="level4">
<h4 class="anchored" data-anchor-id="r-code-for-power-calculation">R Code for Power Calculation:</h4>
<blockquote class="blockquote">
<p>한 연구자가 <strong>특정 운동 프로그램</strong>이 체력에 미치는 효과를 알아보기 위해 <strong>운동 그룹</strong>과 <strong>대조 그룹(운동하지 않는 그룹)</strong>을 비교하는 연구를 설계했다고 가정해보자. 연구자는 운동 프로그램의 효과가 중간 정도(효과 크기 d = 0.5)일 것으로 예상한다. 각 그룹에는 <strong>100명씩</strong>의 참여자가 포함되며, 연구자는 5% 유의 수준에서 검정을 수행하려고 한다. 연구자는 <strong>검정력(power)</strong>이 충분히 높아야만, 즉 잘못된 귀무 가설을 기각할 확률이 높아야만 연구 결과의 신뢰성을 높일 수 있기 때문에 검정력을 계산하게 된다. 검정력이 80% 이상일 때 보통 신뢰할 만한 연구라고 간주되기 때문이다.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the power of a t-test</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 효과 크기, 표본 크기, 유의 수준, 양측 검정을 설정하여 검정력 계산</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>power_result <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">0.5</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"two.sample"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the power of the test</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 100
              d = 0.5
      sig.level = 0.05
          power = 0.9404272
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<ul>
<li><p><strong>검정력 (power)</strong>: 0.94, 즉 94%. 이 값은 연구자가 설정한 조건(효과 크기 0.5, 표본 크기 100명, 유의 수준 0.05)에서, <strong>운동 프로그램이 실제로 효과가 있다면 이를 94% 확률로 감지할 수 있다</strong>는 의미.</p></li>
<li><p>검정력이 80%를 훨씬 넘는 94%로 나타났기 때문에, 연구자는 이 연구 디자인이 충분히 강력하다고 결론 내릴 수 있음. 만약 효과가 존재한다면, 94%의 확률로 이를 올바르게 발견할 수 있기 때문.</p></li>
</ul>
<p><br></p>
</section>
</section>
</section>
<section id="frequentist-vs.-bayesian" class="level2">
<h2 class="anchored" data-anchor-id="frequentist-vs.-bayesian">Frequentist vs.&nbsp;Bayesian</h2>
<blockquote class="blockquote">
<p>어느 날, 당신은 우산을 가져갈지 말지 고민하고 있습니다. 기상청은 “오늘 비가 올 확률이 30%”라고 알려주었다면, Frequentist와 Bayesian 의 접근 방식은 어떻게 달라질까?</p>
<ul>
<li><p>Frequentist는 이 30%를 <strong>장기적인 빈도</strong>로 해석한다. “만약 오늘과 비슷한 조건에서 <strong>100번을 반복한다면</strong>, 그중 30번은 비가 내릴 것이다.” 즉, Frequentist 입장에서는 오늘이 <strong>정확히 비가 오는 날인지 아닌지는 모른 채</strong> 비가 올 가능성을 반복적인 실험 결과로 이해하는 것이다.</p></li>
<li><p>Bayesian은 이 30%를 <strong>현재까지의 정보에 기반한 주관적인 확률</strong>로 해석한다. “오늘 비가 올 확률이 30%”라는 정보를 현재까지의 모든 정보를 반영한 <strong>최신의 신뢰도</strong>로 보는 것이다. 즉, Bayesian 입장에서는 현재 조건에 대해 알고 있는 정보에 따라 <strong>오늘 비가 올 가능성</strong>을 30%로 설정하게 되고 새로운 정보가 들어오면(예: 오후에 구름이 더 많이 끼기 시작) <strong>비 확률을 즉시 업데이트</strong>한다.</p></li>
</ul>
</blockquote>
<p>일상에서 대부분의 사람들은 Bayesian적인 사고 방식에 더 가깝게 행동한다. 우리는 보통 <strong>새로운 정보를 받으면 기존 믿음이나 추정치를 업데이트</strong>하면서 판단을 내리기 때문. Frequentist 접근은 <strong>장기적인 반복 실험</strong>을 전제로 하는데, 이는 일상생활에서는 어렵거나 의미가 없는 경우가 많다. 예를 들어 친구가 약속에 늦을 확률을 알기 위해 <strong>친구가 여러 번 동일한 상황에서 약속을 지키거나 늦는 실험을 반복</strong>할 수는 없기 때문.</p>
<p><br></p>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">1. Introduction</h3>
<p>In statistics, two major schools of thought exist: <strong>Frequentist</strong> and <strong>Bayesian</strong>. Each has its own interpretation of probability, methods of inference, and philosophy. Let’s explore the key differences, along with some intuitive examples and R code for both approaches.</p>
<p><br></p>
</section>
<section id="historical-background" class="level3">
<h3 class="anchored" data-anchor-id="historical-background">2. Historical Background</h3>
<section id="frequentist-approach" class="level4">
<h4 class="anchored" data-anchor-id="frequentist-approach">Frequentist Approach</h4>
<ul>
<li><p><strong>Origins</strong>: The frequentist approach is rooted in the early 20th century, developed by statisticians such as <em>Ronald A. Fisher</em>, <em>Jerzy Neyman</em>, and <em>Egon Pearson.</em></p></li>
<li><p><strong>Philosophy</strong>: Frequentists define probability as the <strong>long-run frequency of events.</strong> They believe that <u><strong>population parameters are fixed but unknown</strong></u>, and they use data from random samples to infer these fixed parameters.</p></li>
<li><p><strong>Example:</strong> If you flip a coin many times, the frequentist interpretation is that the probability of heads is the long-term proportion of heads after infinite flips.</p></li>
</ul>
<p><br></p>
</section>
<section id="bayesian-approach" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-approach">Bayesian Approach</h4>
<ul>
<li><p><strong>Origins</strong>: Bayesian statistics is named after <em>Rev.&nbsp;Thomas Bayes</em>, an 18th-century mathematician. However, it wasn’t until the 20th century that statisticians like <em>Harold Jeffreys</em> and <em>Leonard J. Savage</em> developed Bayesian ideas more thoroughly.</p></li>
<li><p><strong>Philosophy</strong>: In Bayesian statistics, <em>probability represents <strong>a degree of belief</strong> or certainty about an event</em>. Bayesian inference updates this belief as new data becomes available, using <strong>Bayes’ Theorem</strong>.</p></li>
<li><p><strong>Example:</strong> If you believe that the coin is biased based on previous information (e.g., 60% heads in past experiments), you incorporate that into your analysis and update your belief as new flips are observed.</p></li>
<li><p>확률은 수 많은 실험에 의한 빈도가 아니라 내가 어떤 사건이 일어날지에 대한 ’믿음의 정도’로 표현.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="philosophical-differences" class="level3">
<h3 class="anchored" data-anchor-id="philosophical-differences">3. Philosophical Differences</h3>
<section id="frequentist-philosophy" class="level4">
<h4 class="anchored" data-anchor-id="frequentist-philosophy">Frequentist Philosophy</h4>
<ul>
<li><p><strong>Objective</strong>: Population parameters (like the mean or variance) are fixed but unknown, and we use sampling to make inferences about these parameters.</p></li>
<li><p><strong>Probability</strong>: The probability of an event is <strong>the long-run frequency</strong> with which the event occurs over repeated experiments.</p></li>
<li><p><strong>Hypothesis Testing</strong>: Frequentists use <strong>p-values</strong> to test hypotheses and make decisions without explicitly incorporating prior knowledge.</p></li>
<li><p>For example, in hypothesis testing, you might ask: “Given this data, how likely is it to observe this result if the null hypothesis were true?”</p></li>
</ul>
<p><br></p>
</section>
<section id="bayesian-philosophy" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-philosophy">Bayesian Philosophy</h4>
<ul>
<li><p><strong>Subjective</strong>: Bayesian statistics treats parameters as random variables with their own distributions, reflecting uncertainty or prior beliefs.</p></li>
<li><p><strong>Probability</strong>: Probability represents a degree of belief in an event, which is updated as new data is observed.</p></li>
<li><p><strong>Bayes’ Theorem</strong>: The cornerstone of Bayesian inference, Bayes’ Theorem allows us to update prior beliefs about a parameter in light of new evidence.</p></li>
<li><p>For example, you might ask: “Given this data, how should I update my belief about the true parameter?”</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="bayes-theorem" class="level3">
<h3 class="anchored" data-anchor-id="bayes-theorem">4. Bayes’ Theorem</h3>
<p>The key formula that defines Bayesian inference is <strong>Bayes’ Theorem</strong>: <span class="math display">\[
P(\theta | X) = \frac{P(X | \theta) P(\theta)}{P(X)}
\]</span> Where:</p>
<ul>
<li><p><span class="math inline">\(P(\theta | X)\)</span> is the <strong>posterior</strong> probability of the parameter <span class="math inline">\(\theta\)</span> given data <span class="math inline">\(X\)</span>,</p></li>
<li><p><span class="math inline">\(P(X | \theta)\)</span> is the <strong>likelihood</strong>, the probability of observing the data given <span class="math inline">\(\theta\)</span>,</p></li>
<li><p><span class="math inline">\(P(\theta)\)</span> is the <strong>prior</strong> probability, representing our belief about <span class="math inline">\(\theta\)</span> before seeing the data,</p></li>
<li><p><span class="math inline">\(P(X)\)</span> is the <strong>marginal likelihood</strong>, a normalizing constant that ensures the posterior is a valid probability distribution.</p></li>
</ul>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example:</h3>
<p>If you’re trying to estimate the probability of getting heads from a potentially biased coin, the Bayesian approach would combine your prior belief (say, you think the coin might be biased towards heads) with the actual results from a series of flips to calculate an updated belief (the posterior).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prior belief: we think the coin might be biased towards heads</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting an initial prior with Beta distribution: Beta(2, 2) - a slight bias towards heads</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>prior_a <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># Prior heads count (pseudo-count)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>prior_b <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># Prior tails count (pseudo-count)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Observed data: results from flipping the coin</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's assume we flip the coin 20 times and get 14 heads and 6 tails</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>observed_heads <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>observed_tails <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Update the prior with observed data to get the posterior</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>posterior_a <span class="ot">&lt;-</span> prior_a <span class="sc">+</span> observed_heads</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>posterior_b <span class="ot">&lt;-</span> prior_b <span class="sc">+</span> observed_tails</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Plot the prior and posterior distributions to visualize belief updates</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)  <span class="co"># Possible values of the probability of heads</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate density for prior and posterior</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>prior_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, prior_a, prior_b)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>posterior_density <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(theta, posterior_a, posterior_b)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for plotting</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> <span class="fu">rep</span>(theta, <span class="dv">2</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">density =</span> <span class="fu">c</span>(prior_density, posterior_density),</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Prior"</span>, <span class="st">"Posterior"</span>), <span class="at">each =</span> <span class="fu">length</span>(theta))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       theta    density Distribution
1 0.00000000 0.00000000        Prior
2 0.01010101 0.05999388        Prior
3 0.02020202 0.11876339        Prior
4 0.03030303 0.17630854        Prior
5 0.04040404 0.23262932        Prior
6 0.05050505 0.28772574        Prior</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the prior and posterior</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> density, <span class="at">color =</span> Distribution, <span class="at">linetype =</span> Distribution)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bayesian Update for Probability of Heads"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Probability of Heads (θ)"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prior"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Posterior"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="09_week_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Prior 설정</strong>: <code>Beta(2, 2)</code> 분포를 사전 확률로 설정하여 약간 앞면에 치우친 믿음을 반영. <code>prior_a</code>와 <code>prior_b</code>는 각각 사전 앞면과 뒷면의 “pseudo-count”로 설정.</p></li>
<li><p><strong>관찰 데이터</strong>: 동전을 20번 던져 <strong>14번 앞면</strong>이 나오고 <strong>6번 뒷면</strong>이 나온 것을 반영.</p></li>
<li><p><strong>Posterior 업데이트</strong>: 관찰 데이터를 반영해 사후 확률 분포를 업데이트. <code>posterior_a = prior_a + observed_heads</code>, <code>posterior_b = prior_b + observed_tails</code>로 계산.</p></li>
</ul>
<p><br></p>
</section>
<section id="intuitive-examples" class="level3">
<h3 class="anchored" data-anchor-id="intuitive-examples">5. Intuitive Examples</h3>
<section id="example-1-coin-toss-frequentist-vs.-bayesian" class="level4">
<h4 class="anchored" data-anchor-id="example-1-coin-toss-frequentist-vs.-bayesian">Example 1: Coin Toss (Frequentist vs.&nbsp;Bayesian)</h4>
<p><strong>Frequentist Approach:</strong></p>
<p>The frequentist approach to estimating the probability of heads (p) in a coin toss would involve collecting data (number of heads and tails) and estimating p using the <strong>sample proportion</strong>:</p>
<p><span class="math display">\[
\hat{p} = \frac{\text{number of heads}}{\text{total flips}}
\]</span> Frequentists would not incorporate any prior beliefs and rely solely on the data at hand.</p>
<p><br></p>
<p><strong>Bayesian Approach:</strong></p>
<p>Bayesians would start with a <strong>prior distribution</strong> for p, reflecting their belief about the probability of heads before observing any data. After flipping the coin several times, they would update this belief using Bayes’ Theorem to obtain the <strong>posterior distribution</strong> for p.</p>
</section>
<section id="r-code-for-coin-toss-frequentist-vs.-bayesian" class="level4">
<h4 class="anchored" data-anchor-id="r-code-for-coin-toss-frequentist-vs.-bayesian">R Code for Coin Toss (Frequentist vs.&nbsp;Bayesian)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequentist Approach - Coin Toss</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># Number of flips</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>p_true <span class="ot">&lt;-</span> <span class="fl">0.6</span>  <span class="co"># True probability of heads</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p_true)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>freq_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(flips)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Frequentist Estimate of p:"</span>, freq_estimate, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frequentist Estimate of p: 0.6 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian Approach - Coin Toss with Beta Prior</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior: Beta(2, 2) - Reflects prior belief that p is likely around 0.5</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>prior_alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>prior_beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior: Beta(alpha + heads, beta + tails)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>heads <span class="ot">&lt;-</span> <span class="fu">sum</span>(flips)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>tails <span class="ot">&lt;-</span> n <span class="sc">-</span> heads</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>posterior_alpha <span class="ot">&lt;-</span> prior_alpha <span class="sc">+</span> heads</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>posterior_beta <span class="ot">&lt;-</span> prior_beta <span class="sc">+</span> tails</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the Prior and Posterior Distributions</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>prior_dist <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(p_vals, prior_alpha, prior_beta)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>posterior_dist <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(p_vals, posterior_alpha, posterior_beta)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p_vals, prior_dist, posterior_dist)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> p_vals)) <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> prior_dist, <span class="at">color =</span> <span class="st">"Prior"</span>)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> posterior_dist, <span class="at">color =</span> <span class="st">"Posterior"</span>)) <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior and Posterior Distributions"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Probability of Heads (p)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prior"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Posterior"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="09_week_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="r-code-for-bayesian-estimation-of-regression" class="level4">
<h4 class="anchored" data-anchor-id="r-code-for-bayesian-estimation-of-regression">R Code for Bayesian estimation of regression</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the rstanarm package if not already installed</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"rstanarm"</span>)) <span class="fu">install.packages</span>(<span class="st">"rstanarm"</span>, <span class="at">dependencies=</span><span class="cn">TRUE</span>); <span class="fu">library</span>(<span class="st">"rstanarm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rstanarm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Rcpp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is rstanarm version 2.32.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- See https://mc-stan.org/rstanarm/articles/priors for changes to default priors!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- Default priors may change, so it's safest to specify priors, even if equivalent to the defaults.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- For execution on a local, multicore CPU with excess RAM we recommend calling</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  options(mc.cores = parallel::detectCores())</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data: Suppose we have a dataset with predictor X and response Y</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Bayesian linear regression</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>bayesian_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> <span class="fu">data.frame</span>(X, Y),</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>),      </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Prior for coefficients</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>),  </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Prior for intercept</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prior_aux =</span> <span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">2</span>),  </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Prior for error term</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">warmup =</span> <span class="dv">500</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000445 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 4.45 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  501 / 2000 [ 25%]  (Sampling)
Chain 1: Iteration:  700 / 2000 [ 35%]  (Sampling)
Chain 1: Iteration:  900 / 2000 [ 45%]  (Sampling)
Chain 1: Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1: Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1: Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1: Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1: Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.02 seconds (Warm-up)
Chain 1:                0.06 seconds (Sampling)
Chain 1:                0.08 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 1.2e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  501 / 2000 [ 25%]  (Sampling)
Chain 2: Iteration:  700 / 2000 [ 35%]  (Sampling)
Chain 2: Iteration:  900 / 2000 [ 45%]  (Sampling)
Chain 2: Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2: Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2: Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2: Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2: Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.019 seconds (Warm-up)
Chain 2:                0.052 seconds (Sampling)
Chain 2:                0.071 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 1.2e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  501 / 2000 [ 25%]  (Sampling)
Chain 3: Iteration:  700 / 2000 [ 35%]  (Sampling)
Chain 3: Iteration:  900 / 2000 [ 45%]  (Sampling)
Chain 3: Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3: Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3: Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3: Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3: Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.02 seconds (Warm-up)
Chain 3:                0.054 seconds (Sampling)
Chain 3:                0.074 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 1.3e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  501 / 2000 [ 25%]  (Sampling)
Chain 4: Iteration:  700 / 2000 [ 35%]  (Sampling)
Chain 4: Iteration:  900 / 2000 [ 45%]  (Sampling)
Chain 4: Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4: Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 4: Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4: Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4: Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.018 seconds (Warm-up)
Chain 4:                0.057 seconds (Sampling)
Chain 4:                0.075 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Bayesian regression</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bayesian_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      Y ~ X
 observations: 100
 predictors:   2
------
            Median MAD_SD
(Intercept) 3.0    0.3   
X           1.5    0.1   

Auxiliary parameter(s):
      Median MAD_SD
sigma 1.0    0.1   

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<p><br></p>
<p><strong>조금 더 자세한 예제를 통한 학습</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 가상의 데이터 생성</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 샘플 크기</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>true_intercept <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>true_slope <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> true_intercept <span class="sc">+</span> true_slope <span class="sc">*</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 사전 분포 설정 (여기서는 단순히 정규 분포로 가정)</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>prior_mean_intercept <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>prior_sd_intercept <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>prior_mean_slope <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>prior_sd_slope <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>proposal_sd <span class="ot">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># 제안 분포의 표준편차</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 초기값 설정</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">5000</span>  <span class="co"># MCMC 반복 수</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>intercept_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>slope_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 초기 추정치 설정</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>current_intercept <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>current_slope <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>current_log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">dnorm</span>(Y, <span class="at">mean =</span> current_intercept <span class="sc">+</span> current_slope <span class="sc">*</span> X, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. MCMC 과정 (Metropolis-Hastings 알고리즘 사용)</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter) {</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4.1. 새로운 제안값 생성 (정규 분포 제안 분포 사용)</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  proposed_intercept <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current_intercept, <span class="at">sd =</span> proposal_sd)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  proposed_slope <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current_slope, <span class="at">sd =</span> proposal_sd)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4.2. 제안된 값에서의 우도 계산</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  proposed_log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">dnorm</span>(Y, <span class="at">mean =</span> proposed_intercept <span class="sc">+</span> proposed_slope <span class="sc">*</span> X, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4.3. 사전 분포 확률 계산 (정규 분포 가정)</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  prior_current <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(current_intercept, prior_mean_intercept, prior_sd_intercept, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(current_slope, prior_mean_slope, prior_sd_slope, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  prior_proposed <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(proposed_intercept, prior_mean_intercept, prior_sd_intercept, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(proposed_slope, prior_mean_slope, prior_sd_slope, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4.4. 사후 확률 비율 계산 (Metropolis-Hastings acceptance ratio)</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  log_acceptance_ratio <span class="ot">&lt;-</span> (proposed_log_likelihood <span class="sc">+</span> prior_proposed) <span class="sc">-</span> </span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    (current_log_likelihood <span class="sc">+</span> prior_current)</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4.5. 제안값을 수용할지 결정</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">log</span>(<span class="fu">runif</span>(<span class="dv">1</span>)) <span class="sc">&lt;</span> log_acceptance_ratio) {</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>    current_intercept <span class="ot">&lt;-</span> proposed_intercept</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>    current_slope <span class="ot">&lt;-</span> proposed_slope</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    current_log_likelihood <span class="ot">&lt;-</span> proposed_log_likelihood</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4.6. 현재 값을 저장</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  intercept_samples[i] <span class="ot">&lt;-</span> current_intercept</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>  slope_samples[i] <span class="ot">&lt;-</span> current_slope</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 결과 시각화</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(intercept_samples, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Trace Plot: Intercept"</span>, <span class="at">xlab =</span> <span class="st">"Iteration"</span>, <span class="at">ylab =</span> <span class="st">"Intercept"</span>)</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(slope_samples, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Trace Plot: Slope"</span>, <span class="at">xlab =</span> <span class="st">"Iteration"</span>, <span class="at">ylab =</span> <span class="st">"Slope"</span>)</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(intercept_samples, <span class="at">main =</span> <span class="st">"Posterior Distribution: Intercept"</span>, <span class="at">xlab =</span> <span class="st">"Intercept"</span>, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(slope_samples, <span class="at">main =</span> <span class="st">"Posterior Distribution: Slope"</span>, <span class="at">xlab =</span> <span class="st">"Slope"</span>, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="09_week_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 기울기 파라미터가 0보다 클 확률 계산</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>prob_slope_positive <span class="ot">&lt;-</span> <span class="fu">mean</span>(slope_samples <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"기울기 파라미터가 0보다 클 확률:"</span>, prob_slope_positive, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>기울기 파라미터가 0보다 클 확률: 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 기울기의 95% 신뢰 구간 계산</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>credible_interval_slope <span class="ot">&lt;-</span> <span class="fu">quantile</span>(slope_samples, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"기울기의 95% 신뢰 구간:"</span>, credible_interval_slope, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>기울기의 95% 신뢰 구간: 1.372626 1.598481 </code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="example-2-hypothesis-testing-frequentist-vs.-bayesian" class="level3">
<h3 class="anchored" data-anchor-id="example-2-hypothesis-testing-frequentist-vs.-bayesian">6. Example 2: Hypothesis Testing (Frequentist vs.&nbsp;Bayesian)</h3>
<section id="frequentist-hypothesis-testing" class="level4">
<h4 class="anchored" data-anchor-id="frequentist-hypothesis-testing">Frequentist Hypothesis Testing</h4>
<p>In frequentist hypothesis testing, we define a <strong>null hypothesis</strong> H0 (e.g., the population mean is zero) and use a test statistic to determine whether we reject H0 based on a significance level (e.g., <span class="math inline">\(\alpha = 0.05\)</span>).</p>
<ul>
<li><p><strong>왜 귀무 가설이 필요한가?</strong></p>
<p>Frequentist 접근의 기본 철학은 <strong>데이터가 귀무 가설이 참이라는 가정하에서 얼마나 일어날 가능성이 있는지를 평가</strong>하는 데 있다. 이 과정에서 <strong>p-value</strong>를 통해 관찰된 데이터가 귀무 가설 하에서 얼마나 극단적인지(혹은 드문지)를 확인하고, 이를 바탕으로 <strong>귀무 가설을 기각할지 결정한다</strong>.</p></li>
</ul>
<p><br></p>
</section>
<section id="bayesian-hypothesis-testing" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-hypothesis-testing">Bayesian Hypothesis Testing</h4>
<p>In Bayesian hypothesis testing, we compute the <strong>posterior probability</strong> of the hypotheses and compare them directly. Instead of a p-value, we might calculate the <strong>Bayes Factor</strong>, which quantifies the evidence in favor of one hypothesis over another.</p>
<p><br></p>
</section>
<section id="r-code-for-hypothesis-testing-frequentist-vs.-bayesian" class="level4">
<h4 class="anchored" data-anchor-id="r-code-for-hypothesis-testing-frequentist-vs.-bayesian">R Code for Hypothesis Testing (Frequentist vs.&nbsp;Bayesian)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequentist T-test</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> <span class="dv">0</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  data
t = 28.378, df = 99, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 4.818567 5.543057
sample estimates:
mean of x 
 5.180812 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian T-test using BayesFactor package</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("BayesFactor")</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: coda</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>************
Welcome to BayesFactor 0.9.12-4.7. If you have questions, please contact Richard Morey (richarddmorey@gmail.com).

Type BFManual() to open the manual.
************</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian test</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>bf <span class="ot">&lt;-</span> <span class="fu">ttestBF</span>(<span class="at">x =</span> data, <span class="at">mu =</span> <span class="dv">0</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.707 : 7.223809e+45 ±0%

Against denominator:
  Null, mu = 0 
---
Bayes factor type: BFoneSample, JZS</code></pre>
</div>
</div>
<p><u>(베이즈 팩터 설명은 생략)</u></p>
<p><br></p>
</section>
</section>
<section id="key-takeaways" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways">7. Key Takeaways</h3>
<ul>
<li><p><strong>Frequentist</strong> statistics is based on the idea of long-run frequencies, and parameters are treated as fixed. Estimations and hypothesis testing are based purely on observed data without incorporating prior beliefs.</p></li>
<li><p><strong>Bayesian</strong> statistics incorporates prior knowledge and updates this belief using data. Parameters are treated as random variables with their own probability distributions.</p></li>
<li><p><strong>Frequentist tools</strong> include p-values and confidence intervals, while <strong>Bayesian tools</strong> involve posterior distributions and Bayes Factors.</p></li>
</ul>
<p><br></p>
<hr>
</section>
</section>
<section id="anova-analysis-of-variance" class="level2">
<h2 class="anchored" data-anchor-id="anova-analysis-of-variance">ANOVA (Analysis of Variance)</h2>
<p><img src="images/clipboard-730139807.png" class="img-fluid"></p>
<blockquote class="blockquote">
<p><strong>여러 집단 간의 평균 차이</strong>를 분석하기 위한 통계적 기법. <strong>두 개 이상의 집단</strong>이 있을 때, 이 집단들의 <strong>평균이 동일한지</strong>를 검정하는 데 사용됨. ANOVA는 일반적으로 <strong>F-검정</strong>을 통해 수행되며, 집단 간의 분산과 집단 내의 분산을 비교하여 집단 평균의 차이가 통계적으로 유의미한지를 결정.</p>
</blockquote>
<p><br></p>
<section id="anova의-기본-개념" class="level3">
<h3 class="anchored" data-anchor-id="anova의-기본-개념">ANOVA의 기본 개념</h3>
<ol type="1">
<li><strong>귀무가설 (H0)</strong>: 모든 집단의 <strong>평균이 동일</strong>.</li>
</ol>
<p><span class="math display">\[
H_0: \mu_1 = \mu_2 = \cdots = \mu_k
\]</span></p>
<ol start="2" type="1">
<li><strong>대립가설 (H1)</strong>: <strong>적어도 하나의 집단</strong>의 평균이 다르다.</li>
</ol>
<p><br></p>
</section>
<section id="anova의-원리" class="level3">
<h3 class="anchored" data-anchor-id="anova의-원리">ANOVA의 원리</h3>
<p>ANOVA는 <strong>총 변동</strong>을 두 부분으로 나누어 분석.</p>
<ol type="1">
<li><p><strong>집단 간 변동 (Between-group variation)</strong>: 각 집단의 평균이 전체 평균에서 얼마나 벗어나는지를 나타냄. 집단 간 변동이 크다면, 각 집단의 평균이 서로 다를 가능성이 높음.</p></li>
<li><p><strong>집단 내 변동 (Within-group variation)</strong>: 같은 집단 내에서 개별 데이터가 집단 평균에서 얼마나 벗어나는지를 나타냄. 이는 데이터의 <strong>무작위 오차</strong>로 설명할 수 있음.</p></li>
</ol>
<p>예를 들어 세 집단 A, B, C가 있을 때, ANOVA 검정은 다음과 같은 경우에도 귀무 가설을 기각할 수 있음.</p>
<ul>
<li><p>A, B는 비슷한데 C만 평균이 다른 경우</p></li>
<li><p>A, C는 비슷한데 B만 평균이 다른 경우</p></li>
</ul>
<p>즉, <strong>모든 집단이 다르지 않고 하나만 다르더라도</strong> ANOVA는 그 차이를 감지하고, 귀무 가설을 기각할 가능성이 있음. ANOVA는 단순히 “모두 같지 않다”는 사실만을 감지하는 것이므로, 특정 집단이 다르게 보일 경우에도 유의미한 차이가 있다고 판단할 수 있음.</p>
<p><br></p>
</section>
<section id="anova의-f-통계량" class="level3">
<h3 class="anchored" data-anchor-id="anova의-f-통계량">ANOVA의 F-통계량</h3>
<p>ANOVA에서는 <strong>F-통계량</strong>을 계산하여 집단 간 평균 차이가 우연히 발생했는지를 검정. F-통계량은 <strong>집단 간 변동</strong>과 <strong>집단 내 변동</strong>의 비율로 계산.</p>
<p><span class="math display">\[
F = \frac{\text{Between-group variance}}{\text{Within-group variance}}
\]</span></p>
<ul>
<li><strong>집단 간 변동 (Between-group variance or Mean Square Between, MSB)</strong>: 각 집단 평균이 전체 평균에서 벗어나는 정도.</li>
</ul>
<p><span class="math display">\[
\text{MSB} = \frac{\sum_{i=1}^{k} n_i (\bar{X}_i - \bar{X})^2}{k - 1}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(n_i\)</span>: 각 집단의 샘플 크기</p></li>
<li><p><span class="math inline">\(\bar{X}_i\)</span>: 각 집단의 평균</p></li>
<li><p><span class="math inline">\(\bar{X}\)</span>: 전체 평균</p></li>
<li><p><strong>집단 내 변동 (Within-group variance or Mean Square Within, MSW)</strong>: 각 집단 내에서 개별 데이터가 집단 평균에서 벗어나는 정도.</p></li>
</ul>
<p><span class="math display">\[
\text{MSW} = \frac{\sum_{i=1}^{k} \sum_{j=1}^{n_i} (X_{ij} - \bar{X}_i)^2}{N - k}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(X_{ij}\)</span>: i번째 집단의 j번째 관측값</p></li>
<li><p><span class="math inline">\(N\)</span>: 전체 샘플 크기</p></li>
</ul>
<p>F-값이 <strong>1보다 크면</strong>, 집단 간 변동이 집단 내 변동보다 크다는 의미이며, 이는 집단 평균에 차이가 있을 가능성을 시사함.</p>
<p><br></p>
</section>
<section id="anova의-해석" class="level3">
<h3 class="anchored" data-anchor-id="anova의-해석">ANOVA의 해석</h3>
<ul>
<li><p><strong>F-통계량 값이 클수록</strong>: 집단 간 차이가 크고, 이는 <strong>유의미한 차이가 있을 가능성이 높다</strong>는 것을 의미. 따라서 F-통계량이 충분히 큰 경우, 귀무 가설을 기각하고 “적어도 하나의 집단 평균이 다른 집단과 유의미하게 다르다”는 결론을 내릴 수 있음.</p></li>
<li><p><strong>F-통계량 값이 작을수록</strong>: 집단 간 차이가 집단 내 차이에 비해 크지 않다는 것을 의미하며, 이는 <strong>모든 집단 평균이 비슷할 가능성이 높다</strong>는 것을 암시. 이 경우 귀무 가설을 기각할 근거가 부족하다고 볼 수 있음.</p></li>
<li><p><strong>p-값</strong>: F-값에 대응하는 <strong>p-값</strong>이 유의수준(예: 0.05)보다 작으면, <strong>귀무가설을 기각</strong>하고 <strong>집단 간에 평균 차이가 있다</strong>고 결론지을 수 있음.</p></li>
<li><p><strong>귀무가설 기각</strong>: 적어도 하나의 집단 평균이 다른 집단과 다르다는 것을 의미.</p></li>
</ul>
<p><br></p>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<ul>
<li><p>세 개의 서로 다른 교육 방법이 학생들의 수학 성적에 미치는 영향을 분석하고자 한다고 가정.</p></li>
<li><p>각 교육 방법에 대해 10명의 학생 성적 데이터를 수집했고, 세 그룹 간의 평균 성적 차이를 분석하고자 함.</p></li>
</ul>
<p><br></p>
<section id="r-코드-예시" class="level4">
<h4 class="anchored" data-anchor-id="r-코드-예시">R 코드 예시:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 준비</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>group_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">88</span>, <span class="dv">92</span>, <span class="dv">85</span>, <span class="dv">87</span>, <span class="dv">89</span>, <span class="dv">91</span>, <span class="dv">84</span>, <span class="dv">88</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>group_B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">79</span>, <span class="dv">81</span>, <span class="dv">77</span>, <span class="dv">83</span>, <span class="dv">76</span>, <span class="dv">80</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>group_C <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">90</span>, <span class="dv">92</span>, <span class="dv">94</span>, <span class="dv">91</span>, <span class="dv">89</span>, <span class="dv">87</span>, <span class="dv">93</span>, <span class="dv">90</span>, <span class="dv">88</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 데이터프레임으로 결합</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(group_A, group_B, group_C),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">10</span>))</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   score group
1     85     A
2     90     A
3     88     A
4     92     A
5     85     A
6     87     A
7     89     A
8     91     A
9     84     A
10    88     A
11    78     B
12    82     B
13    80     B
14    75     B
15    79     B
16    81     B
17    77     B
18    83     B
19    76     B
20    80     B
21    88     C
22    90     C
23    92     C
24    94     C
25    91     C
26    89     C
27    87     C
28    93     C
29    90     C
30    88     C</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 그룹의 평균</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>mean_A <span class="ot">&lt;-</span> <span class="fu">mean</span>(group_A)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>mean_B <span class="ot">&lt;-</span> <span class="fu">mean</span>(group_B)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>mean_C <span class="ot">&lt;-</span> <span class="fu">mean</span>(group_C)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 평균</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>score)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 그룹 간 제곱합(SSB) 및 제곱 평균(MSB)</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>n_A <span class="ot">&lt;-</span> <span class="fu">length</span>(group_A)  <span class="co"># 각 그룹의 표본 수</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>n_B <span class="ot">&lt;-</span> <span class="fu">length</span>(group_B)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>n_C <span class="ot">&lt;-</span> <span class="fu">length</span>(group_C)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>SSB <span class="ot">&lt;-</span> n_A <span class="sc">*</span> (mean_A <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  n_B <span class="sc">*</span> (mean_B <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  n_C <span class="sc">*</span> (mean_C <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>df_between <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># 그룹 간 자유도</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>MSB <span class="ot">&lt;-</span> SSB <span class="sc">/</span> df_between</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 그룹 내 제곱합(SSW) 및 제곱 평균(MSW)</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>SSW <span class="ot">&lt;-</span> <span class="fu">sum</span>((group_A <span class="sc">-</span> mean_A)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">sum</span>((group_B <span class="sc">-</span> mean_B)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">sum</span>((group_C <span class="sc">-</span> mean_C)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>df_within <span class="ot">&lt;-</span> <span class="fu">length</span>(data<span class="sc">$</span>score) <span class="sc">-</span> <span class="dv">3</span>  <span class="co"># 그룹 내 자유도</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>MSW <span class="ot">&lt;-</span> SSW <span class="sc">/</span> df_within</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. F-통계량 계산</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>F_statistic <span class="ot">&lt;-</span> MSB <span class="sc">/</span> MSW</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"그룹 간 제곱합(SSB):"</span>, SSB, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>그룹 간 제곱합(SSB): 686.4667 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"그룹 간 제곱 평균(MSB):"</span>, MSB, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>그룹 간 제곱 평균(MSB): 343.2333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"그룹 내 제곱합(SSW):"</span>, SSW, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>그룹 내 제곱합(SSW): 173.4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"그룹 내 제곱 평균(MSW):"</span>, MSW, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>그룹 내 제곱 평균(MSW): 6.422222 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"F-통계량:"</span>, F_statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F-통계량: 53.44464 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA 검정 결과와 비교</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> group, <span class="at">data =</span> data)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
group        2  686.5   343.2   53.45 4.1e-10 ***
Residuals   27  173.4     6.4                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot으로 각 그룹의 성적 분포 시각화</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(score <span class="sc">~</span> group, <span class="at">data =</span> data,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Distribution of Scores by Education Method"</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Education Method Group"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Score"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"skyblue"</span>, <span class="st">"salmon"</span>, <span class="st">"lightgreen"</span>))</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 평균선 추가</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>score, data<span class="sc">$</span>group, mean)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, means, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">18</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="09_week_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="anova의-확장" class="level3">
<h3 class="anchored" data-anchor-id="anova의-확장">ANOVA의 확장</h3>
<ol type="1">
<li><p><strong>일원 분산 분석 (One-way ANOVA)</strong>: 위에서 설명한 것처럼 <strong>하나의 요인</strong>(그룹)에 대한 평균 차이를 분석.</p></li>
<li><p><strong>이원 분산 분석 (Two-way ANOVA)</strong>: 두 가지 요인(예: 성별과 교육 방법)이 종속 변수에 미치는 영향을 분석.</p></li>
<li><p><strong>반복 측정 ANOVA</strong>: 동일한 개체에 대해 여러 번 반복 측정한 데이터를 분석.</p></li>
</ol>
<p><br></p>
<p><strong>Two-way ANOVA</strong></p>
<blockquote class="blockquote">
<p><strong>두 개의 독립 변수(factor)</strong>가 종속 변수에 미치는 영향을 동시에 분석하는 방법. 예를 들어, 특정 교육 방법(교육 유형)과 성별이 학생 성적에 미치는 영향을 동시에 분석할 수 있음. Two-way ANOVA에서는 <strong>각 요인의 주 효과(main effects)</strong>와 <strong>두 요인의 상호작용 효과(interaction effect)</strong>를 분석할 수 있음.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: 가상의 데이터 생성</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 교육 방법(A, B)와 성별(Male, Female)이 학생 성적에 미치는 영향을 분석한다고 가정</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># 각 그룹당 샘플 수</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 그룹별 데이터 생성</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>group_A_male <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>group_A_female <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">85</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>group_B_male <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>group_B_female <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">90</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터프레임으로 결합</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(group_A_male, group_A_female, group_B_male, group_B_female),</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>), <span class="at">each =</span> n)),</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Female"</span>), <span class="at">each =</span> n))</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: 데이터 확인</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     score method gender
1 77.19762      A   Male
2 78.84911      A   Male
3 87.79354      A   Male
4 80.35254      A   Male
5 80.64644      A   Male
6 88.57532      A   Male</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Two-way ANOVA 수행</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> method <span class="sc">*</span> gender, <span class="at">data =</span> data)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: 결과 요약 출력</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
method         1    1.3     1.3   0.062    0.805    
gender         1 1602.7  1602.7  73.301 9.24e-13 ***
method:gender  1  483.4   483.4  22.108 1.13e-05 ***
Residuals     76 1661.7    21.9                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: 시각화 (상호작용 효과 플롯)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(data<span class="sc">$</span>method, data<span class="sc">$</span>gender, data<span class="sc">$</span>score,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main =</span> <span class="st">"Interaction Plot: Method and Gender"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">"Method"</span>, <span class="at">ylab =</span> <span class="st">"Score"</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legend =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="09_week_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>method의 p-value가 유의 수준 0.05보다 크기 때문에, 이 요인은 종속 변수에 유의미한 영향을 미치지 않는다고 할 수 있음.</p></li>
<li><p>gender의 p-value가 매우 작으며(&lt;.001) 결과는 성별이 <strong>종속 변수에 매우 유의미한 영향을 미친다는 것을 의미</strong></p></li>
<li><p>상호작용 효과의 p-value가 0.001보다 작기 때문에, <strong>교육 방법과 성별 간에 유의미한 상호작용이 있음을 의미</strong>. 이는 성별과 교육 방법이 결합될 때, 성과에 미치는 영향이 더 달라질 수 있다는 것</p></li>
</ul>
<p><strong>상호작용항이 있는 회귀분석과는 어떻게 다른걸까?</strong></p>
<ul>
<li><p><strong>Two-way ANOVA</strong>: <strong>각 요인의 평균 차이를 검정</strong>하고, <strong>두 요인 간 상호작용이 유의미한지 여부</strong>를 판단하는 데 중점. ANOVA는 주로 실험 데이터를 기반으로 집단 간 차이를 확인하기 위한 비교 도구로 사용.</p></li>
<li><p><strong>회귀분석:</strong> 종속 변수와 독립 변수 간의 <strong>수학적 관계를 모델링</strong>하고, <strong>예측 및 상호작용의 크기와 방향</strong>을 분석하는 데 목적이 있음. 각 계수의 추정치를 바탕으로 회귀식을 구성하며, 이를 통해 새로운 데이터에 대한 예측도 가능.</p></li>
</ul>
<p><br></p>
</section>
<section id="anova의-주요-응용-분야" class="level3">
<h3 class="anchored" data-anchor-id="anova의-주요-응용-분야">ANOVA의 주요 응용 분야</h3>
<ul>
<li><p><strong>실험 설계 분석</strong>: 여러 실험 조건에서 평균 차이를 분석</p></li>
<li><p><strong>임상 연구</strong>: 여러 치료 방법 간의 효과를 비교</p></li>
<li><p><strong>교육 연구</strong>: 여러 교육 방식이 학업 성취도에 미치는 영향을 분석</p></li>
</ul>
<p><br></p>
</section>
<section id="anova의-한계" class="level3">
<h3 class="anchored" data-anchor-id="anova의-한계">ANOVA의 한계</h3>
<ul>
<li><p><strong>분산이 동일하다는 가정</strong>: 모든 집단의 분산이 동일해야 한다는 가정이 있음. 만약 이 가정이 만족되지 않으면 <strong>Welch’s ANOVA</strong>와 같은 다른 방법을 사용할 수 있음.</p></li>
<li><p><strong>정규성 가정</strong>: 데이터가 정규분포를 따른다는 가정이 있지만, 데이터가 크면 이 가정이 완화될 수 있음.</p></li>
</ul>
<p><br></p>
<p><strong>Tukey HSD 사후 검정</strong>:</p>
<ul>
<li><p>ANOVA 결과가 유의미하면, <strong>Tukey HSD</strong>를 사용하여 어떤 그룹 간 차이가 유의미한지 확인할 수 있음.</p></li>
<li><p><code>TukeyHSD()</code>는 ANOVA 결과에서 <strong>그룹 간의 평균 차이</strong>가 유의미한지 여부를 분석.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 패키지 로드</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcompView)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 준비</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>group_A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">88</span>, <span class="dv">92</span>, <span class="dv">85</span>, <span class="dv">87</span>, <span class="dv">89</span>, <span class="dv">91</span>, <span class="dv">84</span>, <span class="dv">88</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>group_B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">79</span>, <span class="dv">81</span>, <span class="dv">77</span>, <span class="dv">83</span>, <span class="dv">76</span>, <span class="dv">80</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>group_C <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">90</span>, <span class="dv">92</span>, <span class="dv">94</span>, <span class="dv">91</span>, <span class="dv">89</span>, <span class="dv">87</span>, <span class="dv">93</span>, <span class="dv">90</span>, <span class="dv">88</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 데이터프레임으로 결합</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(group_A, group_B, group_C),</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">10</span>))</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> group, <span class="at">data =</span> data)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey HSD 사후 검정 수행</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey HSD 결과 확인</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>tukey_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = score ~ group, data = data)

$group
    diff         lwr       upr     p adj
B-A -8.8 -11.6100067 -5.989993 0.0000001
C-A  2.3  -0.5100067  5.110007 0.1244386
C-B 11.1   8.2899933 13.910007 0.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 집단 간 유의미한 차이를 표현하기 위한 그룹화</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>tukey_cld <span class="ot">&lt;-</span> <span class="fu">multcompLetters4</span>(anova_result, tukey_result)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 평균 계산 및 Tukey HSD 결과 결합</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>mean_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(score)) <span class="sc">%&gt;%</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean))</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey HSD 결과를 시각적으로 표현하기 위한 레이블 추가</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>mean_data<span class="sc">$</span>tukey_label <span class="ot">&lt;-</span> tukey_cld<span class="sc">$</span>group<span class="sc">$</span>Letters</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 박스플롯에 Tukey HSD 결과 레이블 추가</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> score, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> mean_data, </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> mean <span class="sc">+</span> <span class="dv">1</span>, <span class="at">label =</span> tukey_label), </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tukey HSD 결과와 그룹 간 평균 차이"</span>, <span class="at">x =</span> <span class="st">"그룹"</span>, <span class="at">y =</span> <span class="st">"성적"</span>) <span class="sc">+</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="09_week_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong><code>multcompLetters4()</code></strong>: <strong><code>multcompView</code></strong> 패키지를 사용해 각 그룹 간 차이를 레이블로 표시. 이 레이블은 평균값 위에 표시되며, <strong>A, B, C</strong> 등으로 그룹 차이를 나타냄.</li>
</ul>
<p><br></p>
</section>
<section id="anova에서-t-분포-시각화-및-t-값-p-값-계산" class="level3">
<h3 class="anchored" data-anchor-id="anova에서-t-분포-시각화-및-t-값-p-값-계산">ANOVA에서 t-분포 시각화 및 t-값, p-값 계산</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 필요한 패키지 설치 및 로드</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shiny UI</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"ANOVA 및 t-검정 시각화"</span>),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">"mean_A"</span>, <span class="st">"A 그룹 평균"</span>, <span class="at">min =</span> <span class="dv">50</span>, <span class="at">max =</span> <span class="dv">100</span>, <span class="at">value =</span> <span class="dv">70</span>),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">"sd_A"</span>, <span class="st">"A 그룹 표준편차"</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">30</span>, <span class="at">value =</span> <span class="dv">10</span>),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">"mean_B"</span>, <span class="st">"B 그룹 평균"</span>, <span class="at">min =</span> <span class="dv">50</span>, <span class="at">max =</span> <span class="dv">100</span>, <span class="at">value =</span> <span class="dv">75</span>),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sliderInput</span>(<span class="st">"sd_B"</span>, <span class="st">"B 그룹 표준편차"</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">30</span>, <span class="at">value =</span> <span class="dv">10</span>),</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">actionButton</span>(<span class="st">"run"</span>, <span class="st">"분석 수행"</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"distPlot"</span>),</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"calculationDisplay"</span>), <span class="co"># 수식과 계산 과정 출력</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">verbatimTextOutput</span>(<span class="st">"finalResult"</span>) <span class="co"># 최종 결과 출력</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Shiny Server</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>run, {</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터 생성</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    A_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, input<span class="sc">$</span>mean_A, input<span class="sc">$</span>sd_A)  <span class="co"># A 그룹 데이터</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    B_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, input<span class="sc">$</span>mean_B, input<span class="sc">$</span>sd_B)  <span class="co"># B 그룹 데이터</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터를 하나의 데이터 프레임으로 결합</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">score =</span> <span class="fu">c</span>(A_data, B_data),</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">30</span>))</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t-test 수행 (두 그룹 간 비교)</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>    t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(A_data, B_data)</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t-검정에서 필요한 값 계산</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>    t_value <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>statistic</span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>parameter</span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>p.value</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t-분포 그리기 위한 x 값 범위 설정</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>    x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t-분포의 밀도 함수 값 계산</span></span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>    t_dist <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_vals, <span class="at">df =</span> df)</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t-분포 그래프 그리기</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(t_value <span class="sc">&gt;=</span> <span class="dv">0</span>){</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>t_dist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">y =</span> t_dist), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># t-분포 곡선</span></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">y =</span> t_dist), x <span class="sc">&gt;=</span> t_value), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># t-값 오른쪽 영역</span></span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">y =</span> t_dist), x <span class="sc">&lt;=</span> <span class="sc">-</span>t_value), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># t-값 왼쪽 영역</span></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span>t_value, t_value), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># t-값 위치 표시 (양쪽)</span></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"t-분포와 t-검정 결과"</span>, <span class="at">x =</span> <span class="st">"t-값"</span>, <span class="at">y =</span> <span class="st">"밀도"</span>) <span class="sc">+</span></span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> t_value <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"t ="</span>, <span class="fu">round</span>(t_value, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># t-값 레이블</span></span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span>t_value <span class="sc">-</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"t ="</span>, <span class="fu">round</span>(<span class="sc">-</span>t_value, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># t-값 레이블</span></span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>t_dist_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">y =</span> t_dist), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># t-분포 곡선</span></span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">y =</span> t_dist), x <span class="sc">&gt;=</span> <span class="sc">-</span>t_value), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># t-값 오른쪽 영역</span></span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">y =</span> t_dist), x <span class="sc">&lt;=</span> t_value), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># t-값 왼쪽 영역</span></span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span>t_value, t_value), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># t-값 위치 표시 (양쪽)</span></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"t-분포와 t-검정 결과"</span>, <span class="at">x =</span> <span class="st">"t-값"</span>, <span class="at">y =</span> <span class="st">"밀도"</span>) <span class="sc">+</span></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> t_value <span class="sc">+</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"t ="</span>, <span class="fu">round</span>(t_value, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># t-값 레이블</span></span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span>t_value <span class="sc">-</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"t ="</span>, <span class="fu">round</span>(<span class="sc">-</span>t_value, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># t-값 레이블</span></span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 수식과 계산 과정 출력</span></span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>calculationDisplay <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">withMathJax</span>(<span class="fu">HTML</span>(<span class="fu">paste</span>(</span>
<span id="cb74-81"><a href="#cb74-81" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;h3&gt;t-검정 계산 과정&lt;/h3&gt;"</span>,</span>
<span id="cb74-82"><a href="#cb74-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;p&gt;t-값 계산:&lt;/p&gt;"</span>,</span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a>        <span class="st">"</span><span class="sc">\\</span><span class="st">[ t = </span><span class="sc">\\</span><span class="st">frac{</span><span class="sc">\\</span><span class="st">bar{X}_A - </span><span class="sc">\\</span><span class="st">bar{X}_B}{</span><span class="sc">\\</span><span class="st">sqrt{</span><span class="sc">\\</span><span class="st">frac{s_A^2}{n_A} + </span><span class="sc">\\</span><span class="st">frac{s_B^2}{n_B}}} </span><span class="sc">\\</span><span class="st">]"</span>,</span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;p&gt;t-값: </span><span class="sc">\\</span><span class="st">( t = "</span>, <span class="fu">round</span>(t_value, <span class="dv">3</span>), <span class="st">" </span><span class="sc">\\</span><span class="st">)&lt;/p&gt;"</span>,</span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;p&gt;자유도(df): </span><span class="sc">\\</span><span class="st">( df = "</span>, <span class="fu">round</span>(df, <span class="dv">0</span>), <span class="st">" </span><span class="sc">\\</span><span class="st">)&lt;/p&gt;"</span>,</span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;p&gt;p-값 계산: </span><span class="sc">\\</span><span class="st">( p = 2 </span><span class="sc">\\</span><span class="st">times P(T &gt; |t|) </span><span class="sc">\\</span><span class="st">)&lt;/p&gt;"</span>,</span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;p&gt;p-값: </span><span class="sc">\\</span><span class="st">( p = "</span>, <span class="fu">round</span>(p_value, <span class="dv">5</span>), <span class="st">" </span><span class="sc">\\</span><span class="st">)&lt;/p&gt;"</span></span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>      )))</span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 최종 결과 출력 (귀무가설 기각 여부)</span></span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>finalResult <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="st">"t-값이"</span>, <span class="fu">round</span>(t_value, <span class="dv">3</span>), <span class="st">"이고 p-값이"</span>, <span class="fu">round</span>(p_value, <span class="dv">5</span>),</span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a>              <span class="st">"이므로 귀무가설을 기각할 수 있습니다. 즉, A 그룹과 B 그룹 간의 평균 차이가 통계적으로 유의미합니다."</span>)</span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="st">"t-값이"</span>, <span class="fu">round</span>(t_value, <span class="dv">3</span>), <span class="st">"이고 p-값이"</span>, <span class="fu">round</span>(p_value, <span class="dv">5</span>),</span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a>              <span class="st">"이므로 귀무가설을 기각할 수 없습니다. </span><span class="sc">\n</span><span class="st"> 즉, A 그룹과 B 그룹 간의 평균 차이가 통계적으로 유의미하지 않습니다."</span>)</span>
<span id="cb74-99"><a href="#cb74-99" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb74-100"><a href="#cb74-100" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb74-101"><a href="#cb74-101" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-102"><a href="#cb74-102" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t-분포와 데이터 분포 시각화</span></span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>distPlot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a>      <span class="co"># 박스플롯과 t-분포 그래프 함께 그리기</span></span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a>      box_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> score, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb74-107"><a href="#cb74-107" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"A 그룹과 B 그룹의 성적 분포"</span>, <span class="at">x =</span> <span class="st">"그룹"</span>, <span class="at">y =</span> <span class="st">"성적"</span>) <span class="sc">+</span></span>
<span id="cb74-108"><a href="#cb74-108" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grid.arrange</span>(box_plot, t_dist_plot, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb74-112"><a href="#cb74-112" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb74-113"><a href="#cb74-113" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Shiny 앱 실행</span></span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a><span class="co"># shinyApp(ui = ui, server = server)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<hr>
</section>
</section>
<section id="experimental-design" class="level2">
<h2 class="anchored" data-anchor-id="experimental-design">Experimental Design</h2>
<p>Experimental design is the process of planning an experiment to ensure that the results can effectively address the research questions posed. A well-designed experiment allows researchers to isolate the effects of independent variables and control for confounding factors, leading to more valid conclusions.</p>
<section id="key-components-of-experimental-design" class="level4">
<h4 class="anchored" data-anchor-id="key-components-of-experimental-design"><strong>Key Components of Experimental Design</strong>:</h4>
<ul>
<li><p><strong>Independent Variable (IV)</strong>: The variable that is manipulated to observe its effect on the dependent variable. In a 2x2 design, there are two independent variables, each with two levels.</p></li>
<li><p><strong>Dependent Variable (DV)</strong>: The outcome or response that is measured to determine the effect of the independent variables.</p></li>
<li><p><strong>Control Variables</strong>: Factors that are kept constant to avoid influencing the results.</p></li>
<li><p><strong>Random Assignment</strong>: The process of assigning participants to experimental conditions in a random manner to ensure that any differences between groups are due to the manipulation of the independent variable rather than pre-existing differences.</p></li>
</ul>
<p><br></p>
</section>
<section id="x2-factorial-design" class="level3">
<h3 class="anchored" data-anchor-id="x2-factorial-design">2x2 Factorial Design</h3>
<p>A <strong>2x2 factorial design</strong> is one of the simplest forms of experimental design where two independent variables, each with two levels, are manipulated simultaneously. This design allows researchers to examine:</p>
<ul>
<li><p>The <strong>main effects</strong> of each independent variable on the dependent variable.</p></li>
<li><p>The <strong>interaction effect</strong> between the two independent variables, which explores whether the effect of one independent variable on the dependent variable depends on the level of the other independent variable.</p></li>
</ul>
<p><br></p>
<section id="x2-design-structure" class="level4">
<h4 class="anchored" data-anchor-id="x2-design-structure"><strong>2x2 Design Structure:</strong></h4>
<ul>
<li><p><strong>Factor 1</strong>: The first independent variable (e.g., treatment type), which has two levels (e.g., placebo and drug).</p></li>
<li><p><strong>Factor 2</strong>: The second independent variable (e.g., time of administration), which also has two levels (e.g., morning and evening).</p></li>
</ul>
<p>This creates four possible experimental conditions:</p>
<ol type="1">
<li><p>Treatment A in the morning.</p></li>
<li><p>Treatment A in the evening.</p></li>
<li><p>Treatment B in the morning.</p></li>
<li><p>Treatment B in the evening.</p></li>
</ol>
<p><br></p>
<blockquote class="blockquote">
<p>Imagine a study examining the effects of <strong>caffeine</strong> (factor 1: with or without caffeine) and <strong>time of day</strong> (factor 2: morning or evening) on <strong>reaction time</strong> (the dependent variable). This 2x2 design will allow the researcher to investigate:</p>
</blockquote>
<ul>
<li><p>The <strong>main effect</strong> of caffeine (Does caffeine improve reaction time?).</p></li>
<li><p>The <strong>main effect</strong> of time of day (Is reaction time better in the morning than in the evening?).</p></li>
<li><p>The <strong>interaction effect</strong> (Is the effect of caffeine different in the morning compared to the evening?).</p></li>
</ul>
<p><br></p>
<p><strong>2x2 실험 연구의 표본 크기 계산</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 패키지 설치 및 로드</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pwr"</span>)) <span class="fu">install.packages</span>(<span class="st">"pwr"</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 효과 크기 (Effect Size)</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 일반적으로 Cohen의 기준을 사용합니다. 예를 들어, 중간 크기의 효과 크기 = 0.25</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fl">0.25</span>  <span class="co"># 필요에 따라 변경</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 유의 수준 (Significance Level)</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># 일반적으로 0.05 사용</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 검정력 (Power)</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fl">0.8</span>  <span class="co"># 일반적으로 0.8 또는 0.9 사용</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2x2 실험에 필요한 표본 크기 계산</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">4</span>,        </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># 총 4개 그룹 (2x2 디자인)</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">f =</span> effect_size, </span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sig.level =</span> alpha, </span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">power =</span> power)</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"각 그룹당 필요한 표본 크기:"</span>, <span class="fu">ceiling</span>(sample_size<span class="sc">$</span>n), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>각 그룹당 필요한 표본 크기: 45 </code></pre>
</div>
</div>
<ul>
<li><p><strong>효과 크기 설정 (effect_size)</strong>: Cohen의 기준에 따라 작은 효과 크기(0.1), 중간 효과 크기(0.25), 큰 효과 크기(0.4)를 선택할 수 있음. 예제에서는 중간 정도의 효과 크기인 0.25로 설정.</p></li>
<li><p><strong>유의 수준 (alpha)</strong>: 일반적으로 0.05로 설정하여, 5%의 유의 수준에서 검정을 수행</p></li>
<li><p><strong>검정력 (power)</strong>: 0.8로 설정하여, 실제 효과가 있는 경우 이를 80%의 확률로 감지할 수 있도록 함.</p></li>
<li><p><strong><code>pwr.anova.test</code> 함수 사용</strong>: 2x2 디자인이므로 총 4개 그룹에 대해 표본 크기를 계산.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="main-effects-and-interaction-effects" class="level3">
<h3 class="anchored" data-anchor-id="main-effects-and-interaction-effects">Main Effects and Interaction Effects</h3>
<section id="main-effects" class="level4">
<h4 class="anchored" data-anchor-id="main-effects"><strong>Main Effects</strong></h4>
<blockquote class="blockquote">
<p>The <strong>main effect</strong> of an independent variable is the effect that it has on the dependent variable, averaging across the levels of the other independent variable.</p>
</blockquote>
<ul>
<li><p><strong>Main effect of IV1 (Caffeine)</strong>: This effect examines whether, overall, participants who received caffeine had faster reaction times than those who did not, regardless of the time of day.</p></li>
<li><p><strong>Main effect of IV2 (Time of Day)</strong>: This effect looks at whether participants had faster reaction times in the morning than in the evening, regardless of whether they received caffeine.</p></li>
</ul>
<p><br></p>
</section>
<section id="interaction-effects" class="level4">
<h4 class="anchored" data-anchor-id="interaction-effects"><strong>Interaction Effects</strong></h4>
<blockquote class="blockquote">
<p>An <strong>interaction effect</strong> occurs when the effect of one independent variable on the dependent variable changes depending on the level of the other independent variable. In a 2x2 factorial design, the interaction effect tests whether the impact of one factor depends on the presence or absence of the other factor.</p>
</blockquote>
<ul>
<li><strong>Example</strong>: The interaction between caffeine and time of day might show that caffeine only improves reaction time in the evening, not in the morning. This would suggest that the effect of caffeine depends on the time of day.</li>
</ul>
<p><br></p>
</section>
<section id="graphical-representation" class="level4">
<h4 class="anchored" data-anchor-id="graphical-representation"><strong>Graphical Representation</strong></h4>
<blockquote class="blockquote">
<p>A useful way to interpret interaction effects is through graphical representation. In a <strong>line plot</strong>, the presence of an interaction is typically indicated when the lines representing different levels of one factor are not parallel. If the lines are parallel, there is no interaction.</p>
</blockquote>
<p><br></p>
</section>
</section>
<section id="between-subjects-vs.-within-subjects-designs" class="level3">
<h3 class="anchored" data-anchor-id="between-subjects-vs.-within-subjects-designs">Between-Subjects vs.&nbsp;Within-Subjects Designs</h3>
<p><img src="https://images.ctfassets.net/pdf29us7flmy/3RTUj5OwbevVjMYNFOsbf3/63fe51efa30e184d240ca9a52ec752ef/between-subjects-design.png?w=1440&amp;q=100&amp;fm=avif" class="img-fluid"></p>
<section id="between-subjects-design" class="level4">
<h4 class="anchored" data-anchor-id="between-subjects-design"><strong>Between-Subjects Design</strong></h4>
<p>In a <strong>between-subjects design</strong>, different participants are assigned to different experimental conditions. This means that each participant experiences only one condition of the experiment.</p>
<ul>
<li><p><strong>Advantages</strong>:</p>
<ul>
<li><p><strong>No carryover effects</strong>, as participants are only exposed to one condition.</p></li>
<li><p>Less participant fatigue since they experience fewer conditions.</p></li>
</ul></li>
<li><p><strong>Disadvantages</strong>:</p>
<ul>
<li><p>More participants are required to maintain statistical power.</p></li>
<li><p>Greater potential for individual differences to influence the results.</p></li>
</ul></li>
</ul>
<p><br></p>
</section>
<section id="within-subjects-design" class="level4">
<h4 class="anchored" data-anchor-id="within-subjects-design"><strong>Within-Subjects Design</strong></h4>
<p>In a <strong>within-subjects design</strong>, the same participants experience all the experimental conditions. This means that participants act as their own control, which reduces the influence of individual differences.</p>
<ul>
<li><p><strong>Advantages</strong>:</p>
<ul>
<li><p>Requires fewer participants, as each participant experiences all conditions.</p></li>
<li><p>Greater statistical power due to reduced variability between conditions.</p></li>
</ul></li>
<li><p><strong>Disadvantages</strong>:</p>
<ul>
<li><p>Potential for <strong>carryover effects</strong>, where the experience of one condition influences responses in subsequent conditions.</p></li>
<li><p>Participant fatigue can occur if the experiment is too long or demanding.</p></li>
</ul></li>
</ul>
<p><br></p>
</section>
<section id="carryover-effect이월-효과" class="level4">
<h4 class="anchored" data-anchor-id="carryover-effect이월-효과"><strong>Carryover effect(이월 효과)</strong></h4>
<blockquote class="blockquote">
<p><strong>실험 연구에서 이전 조건이 이후 조건에 영향을 미치는 현상</strong>. 주로 반복 측정 디자인(repeated measures design)이나 교차 실험(crossover study)에서 나타나며, <strong>두 개 이상의 조건을 순서대로 경험하는 실험</strong>에서 문제가 됨.</p>
</blockquote>
<ul>
<li><p>예를 들어, 피험자가 새로운 학습 방법(A)과 기존 학습 방법(B)을 순서대로 경험하는 연구를 가정,</p>
<ul>
<li><p>피험자가 먼저 학습 방법 A를 경험한 후 학습 방법 B를 경험하면, 학습 방법 A에서 배운 내용이나 방식이 학습 방법 B를 평가할 때 영향을 줄 수 있음.</p></li>
<li><p>이렇게 되면 학습 방법 B의 순수한 효과를 평가하기 어려워지는데, 이는 <strong>학습 방법 A에서의 경험이 학습 방법 B로 이월되었기 때문</strong>.</p></li>
</ul></li>
</ul>
<p><br></p>
<p><strong>Carryover Effect의 종류</strong></p>
<ol type="1">
<li><p><strong>학습 효과(Learning Effect)</strong>: 초기 조건에서의 경험이 이후 조건에서 성과를 향상시키는 경우. 피험자가 실험 절차에 익숙해지거나 기술이 향상되어 이후 조건에서 더 좋은 성과를 낼 수 있음.</p></li>
<li><p><strong>피로 효과(Fatigue Effect)</strong>: 초기 조건에서의 경험으로 인해 피로가 누적되어 이후 조건에서 성과가 저하되는 경우.</p></li>
<li><p><strong>잉여 효과(Residual Effect)</strong>: 특정 조건의 효과가 사라지지 않고 이후 조건에 남아 있는 경우. 예를 들어, 약물 실험에서 특정 약물의 효과가 충분히 사라지지 않은 상태에서 다른 약물을 투여하면 잔여 효과가 새로운 약물의 효과에 영향을 줄 수 있음.</p></li>
</ol>
<p><strong>Carryover Effect를 줄이는 방법</strong></p>
<ol type="1">
<li><p><strong>워시오프 기간(washout period)</strong> 설정: 이전 조건의 효과가 사라질 시간을 확보하기 위해 두 조건 사이에 충분한 시간 간격을 둠.</p></li>
<li><p><strong>조건의 순서를 무작위화(randomization)</strong>: 조건을 다양한 순서로 제공하여 특정 순서에 의해 발생할 수 있는 carryover effect를 최소화. 예를 들어, 절반의 참가자는 A를 먼저 경험하고, 나머지 절반은 B를 먼저 경험하도록 하는 것.</p></li>
<li><p>교차 디자인(crossover design)에서의 통계적 보정: 실험 후 분석 단계에서 carryover effect를 고려하여 결과를 보정할 수 있음.</p></li>
</ol>
<p><br></p>
<p><span class="math display">\[
Y_{ij} = \beta_0 + \beta_1 \cdot \text{Condition}_{ij} + \beta_2 \cdot \text{Period}_{ij} + u_i + \epsilon_{ij}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(Y_{ij}\)</span>: 참가자 <span class="math inline">\(i\)</span>가 <span class="math inline">\(j\)</span>번째 기간에 수행한 결과 (outcome).</p></li>
<li><p><span class="math inline">\(\text{Condition}_{ij}\)</span>: 조건 변수로, 각 기간에 A 또는 B 조건이 적용된 경우를 나타냅니다 (범주형 변수).</p></li>
<li><p><span class="math inline">\(\text{Period}_{ij}\)</span>: 순서 변수로, 첫 번째와 두 번째 기간에 대한 변동성을 나타냅니다 (예: 1 또는 2).</p></li>
<li><p><span class="math inline">\(\beta_0\)</span>: 전체 평균(intercept), 즉 절편.</p></li>
<li><p><span class="math inline">\(\beta_1\)</span>: <strong>조건 효과(Condition effect)</strong>로, A와 B 조건의 차이를 나타냄</p>
<ul>
<li>조건(A 또는 B)에 따라 결과에 미치는 영향의 크기</li>
</ul></li>
<li><p><span class="math inline">\(\beta_2\)</span>: <strong>순서 효과(Period effect)</strong>로, 첫 번째 기간과 두 번째 기간에 따른 효과 차이</p></li>
<li><p><span class="math inline">\(u_i\)</span>: <strong>참가자별 임의 효과(random effect)</strong>로, 참가자 <span class="math inline">\(i\)</span>의 개인적 편차를 나타내며, 이는 참가자 간의 차이를 반영</p>
<ul>
<li><p><span class="math inline">\(u_i\)</span>는 <strong>임의 효과</strong>로, <span class="math inline">\(u_i \sim N(0, \sigma_u^2)\)</span> 의 정규 분포를 따른다고 가정</p></li>
<li><p><strong>임의 효과의 분산</strong> <span class="math inline">\(\sigma_u^2\)</span>: <span class="math inline">\(u_i\)</span>가 개체마다 얼마나 다른지를 설명하는 분산. (우리가 추정하려고 하는 것은 임의 효과의 분산)</p></li>
</ul></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span>: <strong>오차항(residual)</strong>으로, 참가자 <span class="math inline">\(i\)</span>가 <span class="math inline">\(j\)</span>번째 기간에 겪는 랜덤 오차, 독립적으로 정규 분포를 따름.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 가상의 데이터 생성</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each =</span> <span class="dv">2</span>),      <span class="co"># 참가자 ID</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">period =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="dv">10</span>),          <span class="co"># 각 조건의 순서 (1: 첫 번째 조건, 2: 두 번째 조건)</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">1</span>, <span class="at">times =</span> <span class="dv">10</span>),  <span class="co"># 조건 (A와 B)</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)                     <span class="co"># 결과 변수 (Y)</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  participant period condition      outcome
1           1      1         A  0.005764186
2           1      2         B  0.385280401
3           2      1         A -0.370660032
4           2      2         B  0.644376549
5           3      1         A -0.220486562
6           3      2         B  0.331781964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carryover effect 고려한 선형 혼합 모델</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(outcome <span class="sc">~</span> condition <span class="sc">+</span> period <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: outcome ~ condition + period + (1 | participant)
   Data: data

REML criterion at convergence: 49

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.22409 -0.80984  0.07415  0.63691  1.51896 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.1838   0.4288  
 Residual                0.5309   0.7287  
Number of obs: 20, groups:  participant, 10

Fixed effects:
            Estimate Std. Error t value
(Intercept)   0.4730     0.2674   1.769
conditionB   -0.1958     0.3259  -0.601

Correlation of Fixed Effects:
           (Intr)
conditionB -0.609
fit warnings:
fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
</div>
<p><br></p>
<p><strong>임의 효과 (Random Effects)</strong></p>
<ul>
<li><p><strong>참가자(Intercept)</strong>:</p>
<ul>
<li><p><strong>분산 (Variance)</strong>: 0.3736 | <strong>표준 편차 (Std.Dev.)</strong>: 0.6112</p></li>
<li><p>참가자들 간의 절편에 약간의 차이가 있음을 보임. 즉, 참가자 개별의 고유 차이(절편 차이)가 결과 변수에 일부 영향을 미친다는 뜻.</p></li>
</ul></li>
<li><p><strong>잔차 (Residual)</strong>:</p>
<ul>
<li><p><strong>분산 (Variance)</strong>: 0.2865 | <strong>표준 편차 (Std.Dev.)</strong>: 0.5352</p></li>
<li><p><strong>해석</strong>: 잔차의 분산이 참가자 간 절편 분산과 비슷하므로, 모델에서 설명하지 못한 변동성도 여전히 일부 존재한다는 것.</p></li>
</ul></li>
</ul>
<p><br></p>
<p><strong>고정 효과 (Fixed Effects)</strong></p>
<ul>
<li><p><strong>(Intercept)</strong>: 절편의 추정값은 -0.28329이며, 이는 <code>condition = A</code>와 <code>period = 1</code>에서의 예상 outcome 값. 그러나 t 값이 -1.103으로 유의미하지 않으므로, 절편의 값이 통계적으로 의미가 있다고 보기 어려움.</p></li>
<li><p><strong>conditionB</strong>: <code>condition = B</code>일 때 <code>condition = A</code> 대비 outcome에 미치는 효과. 효과 추정치가 0.01578로 매우 작고, t 값도 0.066으로 유의미하지 않으므로, <code>condition</code>이 outcome에 미치는 효과는 통계적으로 유의하지 않은 것으로 보임.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="mixed-factorial-design" class="level3">
<h3 class="anchored" data-anchor-id="mixed-factorial-design">Mixed Factorial Design</h3>
<blockquote class="blockquote">
<p>A <strong>mixed factorial design</strong> combines elements of both between-subjects and within-subjects designs. In this design, one factor is manipulated <strong>between participants</strong> and another is manipulated <strong>within participants</strong>.</p>
</blockquote>
<ul>
<li><strong>Example</strong>: In a study on memory, one group of participants might be exposed to a list of words presented either <strong>audibly</strong> or <strong>visually</strong> (between-subjects factor), while all participants are tested both <strong>immediately</strong> after presentation and <strong>one week later</strong> (within-subjects factor).</li>
</ul>
<p><br></p>
<ul>
<li><strong>데이터 준비 및 구조화</strong>
<ul>
<li><p><strong>집단 간 요인</strong>: <code>presentation_mode</code>로 명명된 요인으로, “audible”과 “visual” 그룹으로 나뉨.</p></li>
<li><p><strong>집단 내 요인</strong>: <code>test_time</code>로 명명된 요인으로, 두 수준(“immediate”와 “one-week later”)을 가짐.</p></li>
<li><p><strong>종속 변수</strong>: 기억력 테스트 점수(<code>memory_score</code>)를 종속 변수로 사용.</p></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p><strong>2x2 혼합 요인 설계</strong>: 집단 간 요인(between-subjects factor)과 집단 내 요인(within-subjects factor)에 따라 같은 집단이 어떻게 배치되는지를 표시</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><strong>제시 방식 (집단 간 요인)</strong></th>
<th><strong>즉시 테스트 (집집단 내 요인)</strong></th>
<th><strong>1주 후 테스트 (집단 내 요인)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>audible (청각적 제시)</strong></td>
<td>조건 1 (Group 1)</td>
<td>조건 2 (Group 1)</td>
</tr>
<tr class="even">
<td><strong>visual (시각적 제시)</strong></td>
<td>조건 3 (Group 2)</td>
<td>조건 4 (Group 2)</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Group 1</strong>: 청각적 제시를 받은 참가자들은 조건 1(즉시 테스트)과 조건 2(1주 후 테스트)를 모두 경험. 이 참가자들은 두 시점에서 반복 측정을 받는 <strong>같은 집단</strong>.</p></li>
<li><p><strong>Group 2</strong>: 시각적 제시를 받은 참가자들은 조건 3(즉시 테스트)과 조건 4(1주 후 테스트)를 모두 경험. 이 참가자들 역시 두 시점에서 반복 측정을 받는 <strong>같은 집단</strong>.</p></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><strong>혼합 요인 설계를 반영한 분석 방법 선택</strong>
<ul>
<li><p><strong>반복 측정 ANOVA</strong>: 두 요인의 주효과와 상호작용 효과를 검정하는 데 적합.</p></li>
<li><p><strong>혼합 효과 모델(mixed-effects model)</strong>: 참가자 간의 고유한 차이를 임의 효과로 포함하여 더 유연하게 분석할 수 있으며, 특히 데이터에 결측치가 있는 경우 더 효과적.</p></li>
</ul></li>
</ul>
<p><br></p>
<section id="a.-반복-측정-anova" class="level4">
<h4 class="anchored" data-anchor-id="a.-반복-측정-anova">A. <strong>반복 측정 ANOVA</strong></h4>
<ul>
<li><p><strong>귀무 가설</strong> (우리가 기각하고자 하는)</p>
<ul>
<li><p><strong>presentation_mode</strong>: 제시 방식에 따른 기억 점수 차이가 없다.</p></li>
<li><p><strong>test_time</strong>: 테스트 시점에 따른 기억 점수 차이가 없다.</p></li>
<li><p><strong>상호작용 효과</strong>: 제시 방식과 테스트 시점이 결합될 때 기억 점수에 추가적인 차이를 유발하지 않는다.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 준비 예시</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">each =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span>)),  </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 30명의 참가자, 각 참가자가 4번 측정</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">presentation_mode =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"audible"</span>, <span class="st">"visual"</span>), <span class="at">each =</span> <span class="dv">60</span>)),  </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 집단 간 요인 (audible vs. visual)</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_time =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"immediate"</span>, <span class="st">"one-week"</span>), <span class="at">times =</span> <span class="dv">30</span>)),     </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 집단 내 요인 (immediate vs. one-week)</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">memory_score =</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)  <span class="co"># 가상의 기억 점수</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  participant presentation_mode test_time memory_score
1           1           audible immediate     42.89593
2           1           audible  one-week     52.56884
3           1           audible immediate     47.53308
4           1           audible  one-week     46.52457
5           2           audible immediate     40.48381
6           2           audible  one-week     49.54972</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 반복 측정 ANOVA 수행</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(memory_score <span class="sc">~</span> presentation_mode <span class="sc">*</span> test_time <span class="sc">+</span> <span class="fu">Error</span>(participant <span class="sc">/</span> test_time), <span class="at">data =</span> data)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Error 함수</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># participant: 각 참가자를 고유하게 구별하기 위한 식별자로, 참가자마다 독립적인 고유 편차를 허용.</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># participant / test_time: 각 참가자가 두 시점에서 반복 측정되므로, participant 내에서 test_time에 따른 오차를 별도로 계산하도록 설정. 이는 각 참가자 내에서 테스트 시점에 따른 변동을 조정하는 역할.</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Error: participant
                  Df Sum Sq Mean Sq F value Pr(&gt;F)
presentation_mode  1  146.9  146.91   1.784  0.192
Residuals         28 2306.0   82.36               

Error: participant:test_time
                            Df Sum Sq Mean Sq F value Pr(&gt;F)
test_time                    1    2.7    2.71   0.035  0.853
presentation_mode:test_time  1   16.1   16.15   0.207  0.653
Residuals                   28 2183.9   78.00               

Error: Within
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 60   6698   111.6               </code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="error-participant" class="level4">
<h4 class="anchored" data-anchor-id="error-participant"><strong>Error: participant</strong></h4>
<ul>
<li><p><code>presentation_mode</code> (청각 vs.&nbsp;시각 제시)</p></li>
<li><p><strong>Df (자유도)</strong>: 1 (두 그룹 간의 비교이므로 자유도는 1)</p></li>
<li><p><code>presentation_mode</code>의 p-value는 0.00568로, 유의 수준 0.01보다 작다. 이는 제시 방식(청각 또는 시각)이 <strong>기억 점수에 유의미한 영향을 미친다는 것을 의미</strong>.</p></li>
<li><p><strong>F 값</strong>이 8.972로 높게 나타났으므로, <code>presentation_mode</code> 요인에서 두 그룹 간의 차이가 유의미함을 나타냄.</p></li>
</ul>
<p><br></p>
</section>
<section id="error-participanttest_time" class="level4">
<h4 class="anchored" data-anchor-id="error-participanttest_time"><strong>Error: participant:test_time</strong></h4>
<ul>
<li><p><code>test_time</code> (즉시 테스트 vs.&nbsp;1주 후 테스트) 및 <code>presentation_mode:test_time</code> 상호작용 효과</p></li>
<li><p><strong><code>test_time</code></strong>: <code>test_time</code>의 p-value가 0.300로 유의 수준 0.05보다 크므로, <strong>즉시 테스트와 1주 후 테스트 간의 기억 성과 차이는 통계적으로 유의미하지 않다</strong>고 해석할 수 있음.</p></li>
<li><p><strong><code>presentation_mode:test_time</code> 상호작용</strong>: 상호작용 효과의 p-value가 0.955로 매우 높아, <strong>제시 방식(presentation_mode)과 테스트 시점(test_time) 간에 유의미한 상호작용 효과는 존재하지 않는다고 볼 수 있음.</strong></p></li>
</ul>
<p><br></p>
</section>
<section id="b.-혼합-효과-모델-mixed-effects-model" class="level4">
<h4 class="anchored" data-anchor-id="b.-혼합-효과-모델-mixed-effects-model">B. <strong>혼합 효과 모델 (Mixed-Effects Model)</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 패키지 설치 및 로드</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"lme4"</span>)) <span class="fu">install.packages</span>(<span class="st">"lme4"</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 혼합 효과 모델 수행</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>mixed_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(memory_score <span class="sc">~</span> presentation_mode <span class="sc">*</span> test_time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: memory_score ~ presentation_mode * test_time + (1 | participant)
   Data: data

REML criterion at convergence: 872.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.9495 -0.7197 -0.1080  0.5654  3.2466 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept)  0.00    0.000   
 Residual                96.45    9.821   
Number of obs: 120, groups:  participant, 30

Fixed effects:
                                          Estimate Std. Error t value
(Intercept)                                 48.614      1.793  27.112
presentation_modevisual                      1.479      2.536   0.583
test_timeone-week                           -1.034      2.536  -0.408
presentation_modevisual:test_timeone-week    1.467      3.586   0.409

Correlation of Fixed Effects:
            (Intr) prsnt_ tst_t-
prsnttn_mdv -0.707              
test_tmn-wk -0.707  0.500       
prsnttn_:_-  0.500 -0.707 -0.707
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<p><br></p>
<p><code>presentation_mode</code>와 <code>test_time</code>의 주효과와 상호작용 효과를 추정할 수 있으며, <code>participant</code>를 임의 효과로 추가하여 각 참가자의 고유한 차이를 모델에 반영 (random effect). 이를 통해 참가자 간 차이를 보정하고, 요인 효과에 집중할 수 있음.</p>
<p><br></p>
<ul>
<li><p><strong>주효과</strong></p>
<ul>
<li><p><code>presentation_mode</code>의 주효과: 제시 방식이 기억 점수에 유의미한 영향을 미치는지 확인.</p></li>
<li><p><code>test_time</code>의 주효과: 테스트 시점에 따라 기억 점수에 유의미한 차이가 있는지 확인.</p></li>
</ul></li>
<li><p><strong>상호작용 효과</strong>: <code>presentation_mode:test_time</code> 상호작용 효과는 제시 방식에 따라 테스트 시점의 효과가 달라지는지를 나타냄. 상호작용이 유의미하다면, 특정 제시 방식에서 시간이 지남에 따라 기억 성과가 달라지는 경향이 나타날 수 있음.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="언제-어떤-방법을-사용할까" class="level3">
<h3 class="anchored" data-anchor-id="언제-어떤-방법을-사용할까">언제 어떤 방법을 사용할까?</h3>
<ul>
<li><p><strong>반복 측정 ANOVA</strong>: 데이터가 균형 잡히고 결측치가 없을 때 적합.</p></li>
<li><p><strong>혼합 효과 모델</strong>: 참가자 간의 고유한 차이를 반영하고, 결측치가 있거나 데이터가 불균형한 경우에도 유연하게 적용할 수 있음. <u>또한 effect size 와 방향에 관심이 있다면 혼합 효과 모형!</u></p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="마치며" class="level2">
<h2 class="anchored" data-anchor-id="마치며">마치며</h2>
<p>ANOVA와 관련된 흥미로운 일화</p>
<p>ANOVA를 창시한 로널드 피셔(Ronald A. Fisher)와 그의 동료의 이야기 (From his book “The Design of Experiments”)</p>
<section id="차-티백을-넣을까-우유를-먼저-넣을까" class="level4">
<h4 class="anchored" data-anchor-id="차-티백을-넣을까-우유를-먼저-넣을까">“차 티백을 넣을까, 우유를 먼저 넣을까?”</h4>
<p>피셔와 동료들은 어느 날 차를 마시며, 우유를 먼저 넣느냐, 차를 먼저 붓느냐에 따라 맛이 달라질까?라는 질문을 두고 논쟁을 벌였습니다. 그러던 중 머리어 레이디팅이 <strong>자신이 어떤 순서로 차를 만들었는지를 정확히 맞힐 수 있다</strong>고 주장했습니다. 피셔는 이를 기회로 삼아, 실제로 레이디팅이 티의 순서를 감별할 수 있는지 검증하기 위해 작은 실험을 고안했습니다. (쓸데 없이 진지..)</p>
</section>
<section id="실험-설계-무작위-대조-실험randomized-controlled-experiment" class="level3">
<h3 class="anchored" data-anchor-id="실험-설계-무작위-대조-실험randomized-controlled-experiment">실험 설계: 무작위 대조 실험(Randomized Controlled Experiment)</h3>
<p>피셔는 <strong>실험을 통해 레이디팅의 감별 능력이 실제로 우연을 넘어서는지를 확인하기 위해, 매우 체계적으로 실험을 설계</strong>했습니다.</p>
<ol type="1">
<li><p><strong>실험 목표</strong>: 레이디팅이 단순히 우연히 맞히는 것이 아니라, 실제로 차와 우유의 순서를 구별할 수 있는지를 확인.</p></li>
<li><p><strong>처치 조건 설정</strong></p>
<ul>
<li><p>피셔는 차를 준비하는 방법을 두 가지로 나누었음.</p>
<ul>
<li><p><strong>우유 먼저 넣은 차</strong> (처치 조건 1)</p></li>
<li><p><strong>차를 먼저 넣은 차</strong> (처치 조건 2)</p></li>
</ul></li>
</ul></li>
<li><p><strong>무작위로 제시</strong></p>
<ul>
<li><p>피셔는 총 8잔의 차를 준비하였으며, 이 중 절반인 4잔은 <strong>우유를 먼저 넣고</strong>, 나머지 4잔은 <strong>차를 먼저 부은</strong> 차로 준비.</p></li>
<li><p>이 차 8잔의 순서를 <strong>무작위로 배치</strong>하여 레이디팅에게 제시했습니다. 이는 <strong>무작위 대조 실험</strong>의 일종으로, 순서가 예측되지 않도록 하여 <strong>실험의 타당성을 확보</strong>하려는 시도.</p></li>
</ul></li>
<li><p><strong>레이디팅의 시음과 답변</strong></p>
<ul>
<li><p>레이디팅 박사는 각 차를 시음하고, 각 잔이 <strong>우유를 먼저 넣었는지, 차를 먼저 넣었는지</strong>를 구별해야 했음.</p></li>
<li><p>그녀는 시음 후 각 잔의 차를 “우유 먼저” 또는 “차 먼저”로 분류.</p></li>
</ul></li>
<li><p><strong>검증 기준</strong></p>
<ul>
<li><p>피셔는 <strong>통계적 유의미성을 검정</strong>하기 위해, 레이디팅이 우연히 맞힐 확률과 실제로 맞힐 확률을 비교할 수 있도록 설정. <u><strong>(여기가 핵심!)</strong></u></p></li>
<li><p>만약 레이디팅이 8잔 중 절반 이상을 정확히 구분할 경우, 이는 우연을 넘어서는 결과로 판단하고, 그녀의 주장이 검증된다고 해석할 수 있는 설정이었음.</p></li>
</ul></li>
</ol>
</section>
<section id="실험-결과와-통계적-해석" class="level3">
<h3 class="anchored" data-anchor-id="실험-결과와-통계적-해석">실험 결과와 통계적 해석</h3>
<p>실험 결과, 레이디팅은 상당히 정확하게 <strong>우유와 차의 순서를 구별</strong>해냈고, 이는 피셔에게 <strong>데이터 변동성에 따른 귀무 가설 검정의 중요성</strong>을 시사했습니다. 이 실험은 피셔가 ANOVA와 같은 <strong>통계적 검정 방법</strong>을 개발하는 데 중요한 영감을 제공했으며, 실험 설계와 통계학에서 <strong>유의성 검정</strong>의 초석이 되었습니다.</p>
<section id="the-end" class="level4">
<h4 class="anchored" data-anchor-id="the-end"><strong>The End!</strong></h4>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ChangjunChrisLee/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Dr_CJLee">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>