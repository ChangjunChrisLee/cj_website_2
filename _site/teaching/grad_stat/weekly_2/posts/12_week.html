<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hayes Models(1) – CJL &amp; Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">CJL &amp; Lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Courses</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-courses">    
        <li>
    <a class="dropdown-item" href="../../../../teaching/index.html">
 <span class="dropdown-text">All Courses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../teaching/ds101/index.html">
 <span class="dropdown-text">DS101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../teaching/ml101/index.html">
 <span class="dropdown-text">ML101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../teaching/grad_stat/index.html">
 <span class="dropdown-text">STAT101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../teaching/grad_immersive/index.html">
 <span class="dropdown-text">IMUX</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blogs/index.html"> 
<span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://axislab.netlify.app/"> 
<span class="menu-text">LAB</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#hayes-process-model-an-introduction-and-practical-application-in-r" id="toc-hayes-process-model-an-introduction-and-practical-application-in-r" class="nav-link active" data-scroll-target="#hayes-process-model-an-introduction-and-practical-application-in-r">Hayes Process Model: An Introduction and Practical Application in R</a>
  <ul class="collapse">
  <li><a href="#introduction-to-hayes-process-models" id="toc-introduction-to-hayes-process-models" class="nav-link" data-scroll-target="#introduction-to-hayes-process-models"><strong>Introduction to Hayes Process Models</strong></a></li>
  <li><a href="#mediation-analysis" id="toc-mediation-analysis" class="nav-link" data-scroll-target="#mediation-analysis"><strong>Mediation Analysis</strong></a></li>
  <li><a href="#moderation-analysis" id="toc-moderation-analysis" class="nav-link" data-scroll-target="#moderation-analysis"><strong>Moderation Analysis</strong></a></li>
  <li><a href="#moderated-mediation-conditional-process" id="toc-moderated-mediation-conditional-process" class="nav-link" data-scroll-target="#moderated-mediation-conditional-process"><strong>Moderated Mediation (Conditional Process)</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hayes Models(1)</h1>
<p class="subtitle lead">Mediation &amp; Moderation</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://changjunlee.com/teaching/grad_stat/weekly_2/">Weekly content</a></p>
<p><br></p>
<section id="hayes-process-model-an-introduction-and-practical-application-in-r" class="level2">
<h2 class="anchored" data-anchor-id="hayes-process-model-an-introduction-and-practical-application-in-r">Hayes Process Model: An Introduction and Practical Application in R</h2>
<section id="introduction-to-hayes-process-models" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-hayes-process-models"><strong>Introduction to Hayes Process Models</strong></h3>
<p>The <strong>Hayes Process Models</strong> provide a powerful framework for analyzing complex relationships between variables in social, behavioral, and other scientific research fields. Developed by <em>Andrew F. Hayes</em>, this approach offers a set of statistical tools that allow researchers to explore and test relationships that go beyond simple linear correlations. These models focus on <strong>mediation</strong>, <strong>moderation</strong>, and <strong>conditional process modeling</strong>, offering a clear method for investigating how and when effects occur.</p>
<p><br></p>
<section id="what-is-mediation-moderation-and-conditional-process-modeling" class="level4">
<h4 class="anchored" data-anchor-id="what-is-mediation-moderation-and-conditional-process-modeling"><strong>What is Mediation, Moderation, and Conditional Process Modeling?</strong></h4>
<p><br></p>
<ol type="1">
<li><p><strong>Mediation</strong><br>
<img src="images/clipboard-537904527.png" class="img-fluid" width="400"></p>
<ul>
<li><p>Mediation analysis helps identify <strong>why</strong> or <strong>how</strong> a certain effect occurs. It examines whether the relationship between an independent variable (X) and a dependent variable (Y) is explained, at least partially, by a third variable called the <strong>mediator</strong> (M). In simpler terms, mediation investigates if X affects Y <strong>through</strong> M, by decomposing the total effect of X on Y into direct and indirect effects.</p></li>
<li><p><strong>Example</strong>: A researcher might hypothesize that the impact of study habits (X) on academic performance (Y) is mediated by motivation (M). The mediation model would test whether better study habits increase motivation, which in turn improves academic performance.</p></li>
</ul></li>
</ol>
<p><br></p>
<ol start="2" type="1">
<li><p><strong>Moderation</strong><br>
<img src="images/clipboard-807546320.png" class="img-fluid" width="400"></p>
<ul>
<li><p>Moderation analysis looks at <strong>when</strong> or <strong>under what conditions</strong> a relationship between X and Y holds. It introduces a <strong>moderator</strong> variable (W), which influences the strength or direction of the effect that X has on Y. The goal is to determine if the effect of X on Y changes depending on the level of W.</p></li>
<li><p><strong>Example</strong>: A company might test whether the relationship between employee training (X) and job performance (Y) depends on the years of experience (W) the employees have. If training improves job performance more for experienced workers than for beginners, experience moderates the training-performance relationship.</p></li>
</ul></li>
</ol>
<p><br></p>
<ol start="3" type="1">
<li><p><strong>Conditional Process Modeling</strong><br>
<img src="images/clipboard-1801120322.png" class="img-fluid" width="400"></p>
<ul>
<li><p>Conditional process modeling combines mediation and moderation, exploring <strong>both how</strong> and <strong>when</strong> an effect occurs. It investigates whether the indirect effect of X on Y through M is conditional upon the level of a moderator W, allowing researchers to examine more nuanced relationships.</p></li>
<li><p><strong>Example</strong>: A researcher could examine whether the indirect effect of parental involvement (X) on a child’s academic success (Y) through school engagement (M) depends on the socio-economic status (W) of the family. In this case, socio-economic status moderates the indirect effect of parental involvement on academic success.</p></li>
</ul></li>
</ol>
<p><br></p>
</section>
<section id="the-importance-of-hayes-process-models" class="level4">
<h4 class="anchored" data-anchor-id="the-importance-of-hayes-process-models"><strong>The Importance of Hayes Process Models</strong></h4>
<p>Hayes’ models have become increasingly popular because they provide a comprehensive and structured way to test hypotheses involving complex variable relationships. They allow researchers to:</p>
<ul>
<li><p>Analyze <strong>causal mechanisms</strong> and understand the <strong>process</strong> through which an independent variable influences an outcome.</p></li>
<li><p>Determine under what <strong>conditions</strong> an effect holds, identifying critical contextual or situational factors.</p></li>
<li><p>Move beyond traditional statistical approaches, which often assume linear, direct relationships, by modeling <strong>indirect</strong>, <strong>conditional</strong>, or <strong>interactive</strong> effects.</p></li>
</ul>
<p>The statistical foundation for these models is rooted in <strong>ordinary least squares (OLS) regression</strong> and <strong>bootstrapping</strong> methods, which allow for robust hypothesis testing even when assumptions such as normality are violated. Hayes’ popular PROCESS macro, which integrates into software like SPSS, SAS, and R, simplifies the estimation of mediation and moderation models, making it accessible for researchers with varying levels of statistical expertise.</p>
<p><br></p>
</section>
<section id="types-of-hayes-models" class="level4">
<h4 class="anchored" data-anchor-id="types-of-hayes-models"><strong>Types of Hayes Models</strong></h4>
<p>Hayes developed over <strong>90 distinct models</strong> for mediation, moderation, and moderated mediation. Each model is designed for different types of hypotheses:</p>
<ul>
<li><p><strong>Model 4</strong> is widely used for simple mediation.</p></li>
<li><p><strong>Model 1</strong> tests for simple moderation.</p></li>
<li><p><strong>Model 7</strong> is a common choice for moderated mediation (also known as conditional process models).</p></li>
</ul>
<p>These models provide flexible and easily interpretable ways to test intricate theoretical relationships.</p>
<p><br></p>
</section>
</section>
<section id="mediation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="mediation-analysis"><strong>Mediation Analysis</strong></h3>
<p>Mediation analysis is a statistical technique used to explore the underlying process or mechanism through which an independent variable (X) influences a dependent variable (Y) through a third variable, called the <strong>mediator</strong> (M). This chapter will provide an in-depth look at the theory behind mediation, introduce you to the necessary statistical steps, and show how to conduct mediation analysis using R with practical examples.</p>
<section id="conceptual-background-of-mediation" class="level4">
<h4 class="anchored" data-anchor-id="conceptual-background-of-mediation"><strong>Conceptual Background of Mediation</strong></h4>
<p>In many research scenarios, a simple direct relationship between an independent variable and a dependent variable does not fully explain the phenomenon being studied. Mediation analysis is useful when we suspect that this relationship is at least partly driven by an intermediate variable, called the <strong>mediator</strong>. The goal is to assess both the <strong>direct effect</strong> of X on Y and the <strong>indirect effect</strong>, which is the portion of the effect that passes through M.</p>
<p><strong>Path Diagram for Mediation</strong></p>
<p>A typical mediation model is illustrated with three paths:</p>
<ul>
<li><p>Path <strong>a</strong>: The effect of the independent variable (X) on the mediator (M).</p></li>
<li><p>Path <strong>b</strong>: The effect of the mediator (M) on the dependent variable (Y), while controlling for X.</p></li>
<li><p>Path <strong>c’</strong>: The direct effect of X on Y, while controlling for the mediator (M).</p></li>
<li><p><strong>Indirect effect</strong>: The product of paths <strong>a</strong> and <strong>b</strong>, representing the portion of the effect of X on Y that occurs through M.</p></li>
</ul>
<p><strong>Mediation Formula</strong></p>
<p>The relationship between the variables is expressed using the following equations:</p>
<p><span class="math display">\[
M = aX + e_1
\]</span> <span class="math display">\[
Y= bM + c'X + e_2
\]</span></p>
<p>Where:</p>
<ul>
<li><p><strong>a</strong> is the regression coefficient for the effect of X on M.</p></li>
<li><p><strong>b</strong> is the regression coefficient for the effect of M on Y (controlling for X).</p></li>
<li><p><strong>c’</strong> is the direct effect of X on Y after accounting for the mediator.</p></li>
</ul>
<p><br></p>
</section>
<section id="total-effect" class="level4">
<h4 class="anchored" data-anchor-id="total-effect"><strong>Total Effect</strong></h4>
<p>The total effect of X on Y is the sum of:</p>
<ul>
<li><p>The <strong>direct effect</strong> of X on Y (c’).</p></li>
<li><p>The <strong>indirect effect</strong>, which is mediated through M.</p></li>
</ul>
<p>Mathematically:</p>
<p><span class="math display">\[
c=c'+(a \cdot b)
\]</span></p>
<p>Where:</p>
<ul>
<li><p>c: Total effect of X on Y.</p></li>
<li><p>c’: Direct effect of X on Y (not through M ).</p></li>
<li><p><span class="math inline">\(a \cdot b\)</span>: Indirect effect of X on Y via M.</p></li>
</ul>
<p><br></p>
</section>
<section id="steps-in-mediation-analysis" class="level4">
<h4 class="anchored" data-anchor-id="steps-in-mediation-analysis"><strong>Steps in Mediation Analysis</strong></h4>
<p>Mediation analysis generally follows three main steps:</p>
<ol type="1">
<li><p><strong>Testing the effect of X on M (path a)</strong>:</p>
<ul>
<li>This step assesses whether X significantly predicts the mediator (M). If X does not affect M, there is no mediation.</li>
</ul></li>
<li><p><strong>Testing the effect of M on Y while controlling for X (path b)</strong>:</p>
<ul>
<li>This step tests whether M affects Y when controlling for X. A significant relationship between M and Y indicates that M is a mediator.</li>
</ul></li>
<li><p><strong>Testing the direct effect of X on Y (path c’)</strong>:</p>
<ul>
<li>The total effect of X on Y (before including M) is divided into two parts: the direct effect (<strong>c’</strong>) and the indirect effect (<strong>ab</strong>). If the direct effect <strong>c’</strong> is significantly reduced when M is included, this supports the presence of mediation.</li>
</ul></li>
</ol>
<p><br></p>
<p><strong>Bootstrapping for Mediation</strong></p>
<p>Since the product of coefficients (a * b) often has a non-normal distribution, bootstrapping is commonly used to obtain more accurate confidence intervals for the indirect effect. Bootstrapping repeatedly samples the data with replacement to estimate the distribution of the indirect effect, which allows for more robust statistical inferences.</p>
<p><br></p>
</section>
<section id="example-simple-mediation-using-hayes-model-4-in-r" class="level4">
<h4 class="anchored" data-anchor-id="example-simple-mediation-using-hayes-model-4-in-r"><strong>Example: Simple Mediation Using Hayes’ Model 4 in R</strong></h4>
<p>To illustrate mediation analysis, we will use <strong>Hayes’ Model 4</strong>—a simple mediation model. Below is an example of how to run a mediation analysis in R using a fictional dataset where the independent variable (X) is <strong>hours studied</strong>, the mediator (M) is <strong>motivation</strong>, and the dependent variable (Y) is <strong>test score</strong>.</p>
<p><br></p>
<p><strong>Data Simulation Example</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating the dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)  <span class="co"># Hours studied</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(n)           <span class="co"># Motivation (mediator)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> M <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(n) <span class="co"># Test score (dependent variable)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">M =</span> M, <span class="at">Y =</span> Y)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          X        M        Y
1  8.879049 6.638335 6.573159
2  9.539645 6.082235 5.342583
3 13.117417 6.293563 7.076615
4 10.141017 5.613702 6.381685
5 10.258575 4.714948 6.577237
6 13.430130 6.238818 6.121783</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Running Mediation Analysis in R</strong></p>
<p>We will use the <code>mediation</code> package in R, which provides functions for conducting mediation analysis. First, we fit two linear models: one for predicting the mediator (M) and one for predicting the outcome (Y).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the mediation package</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("mediation")</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sandwich</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mediation: Causal Mediation Analysis
Version: 4.5.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Fit the model for the mediator</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>med_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(M <span class="sc">~</span> X, <span class="at">data =</span> data)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Fit the model for the outcome</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>out_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X, <span class="at">data =</span> data)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Conduct mediation analysis</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>mediation_analysis <span class="ot">&lt;-</span> <span class="fu">mediate</span>(med_model, </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                              out_model, </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">treat =</span> <span class="st">"X"</span>, </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mediator =</span> <span class="st">"M"</span>, </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">boot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sims =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running nonparametric bootstrap</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mediation_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Causal Mediation Analysis 

Nonparametric Bootstrap Confidence Intervals with the Percentile Method

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME              0.267        0.205         0.35  &lt;2e-16 ***
ADE               0.309        0.202         0.41  &lt;2e-16 ***
Total Effect      0.576        0.477         0.66  &lt;2e-16 ***
Prop. Mediated    0.463        0.346         0.61  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Sample Size Used: 200 


Simulations: 500 </code></pre>
</div>
</div>
<p><br></p>
<p><strong>Interpreting the Results</strong></p>
<p>The output of the <code>mediate()</code> function provides several key statistics:</p>
<ul>
<li><p><strong>ACME (Average Causal Mediation Effect)</strong>: This is the estimated <strong>indirect effect</strong> (a * b). If it is significantly different from zero, we can conclude that mediation exists.</p></li>
<li><p><strong>ADE (Average Direct Effect)</strong>: This represents the <strong>direct effect</strong> (c’) of X on Y, after accounting for the mediator.</p></li>
<li><p><strong>Total Effect</strong>: The sum of the direct and indirect effects.</p></li>
<li><p><strong>Proportion Mediated</strong>: The proportion of the total effect that is mediated by M.</p></li>
</ul>
<p>An example interpretation might be:</p>
<ul>
<li><p>The indirect effect of <strong>hours studied</strong> on <strong>test scores</strong> through <strong>motivation</strong> is significant, meaning motivation partially mediates the relationship between hours studied and test scores.</p></li>
<li><p>The direct effect of hours studied on test scores remains significant even after accounting for motivation, indicating that both direct and mediated effects are important.</p></li>
</ul>
<p><br></p>
</section>
<section id="limitations-of-mediation-analysis" class="level4">
<h4 class="anchored" data-anchor-id="limitations-of-mediation-analysis"><strong>Limitations of Mediation Analysis</strong></h4>
<p>While mediation analysis is powerful, it is not without its limitations:</p>
<ul>
<li><p><strong>Causality</strong>: Mediation assumes a causal order (X → M → Y), but establishing causality requires more than just statistical analysis (e.g., experimental designs or longitudinal data).</p></li>
<li><p><strong>Confounding Variables</strong>: Unaccounted confounders can bias the results. It’s important to ensure that potential confounders are controlled for in the analysis.</p></li>
<li><p><strong>Measurement Error</strong>: Inaccurate measurement of X, M, or Y can distort the mediation effect.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="moderation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="moderation-analysis"><strong>Moderation Analysis</strong></h3>
<p>Moderation analysis is a statistical technique used to explore how the relationship between an independent variable (X) and a dependent variable (Y) changes depending on the level of a third variable, known as the <strong>moderator</strong> (W). This technique allows researchers to examine <u><strong><em>when and under what conditions an effect occurs</em></strong></u>, rather than simply whether or not it exists.</p>
<p><br></p>
<section id="conceptual-background-of-moderation" class="level4">
<h4 class="anchored" data-anchor-id="conceptual-background-of-moderation"><strong>Conceptual Background of Moderation</strong></h4>
<p>In many research contexts, the relationship between an independent variable (X) and a dependent variable (Y) is not consistent across all situations or individuals. Instead, this relationship may depend on a third variable, called the <strong>moderator</strong> (W). Moderation occurs when the effect of X on Y varies depending on the level of W.</p>
<p>Moderation analysis answers the question: “<strong>When or under what conditions does X influence Y?</strong>” For example, the relationship between study time (X) and test performance (Y) may depend on the student’s motivation (W). If motivation is high, the effect of study time on test performance might be stronger than when motivation is low.</p>
<p>Moderation occurs when the strength or direction of the relationship between two variables (X and Y) is influenced by a third variable (W). Rather than explaining how the effect happens (as in mediation), moderation analysis addresses the question of <strong>when</strong> or <strong>under what conditions</strong> an effect is stronger, weaker, or even reversed.</p>
<p>A moderator can be either:</p>
<ul>
<li><p><strong>Quantitative</strong> (e.g., income, age, temperature) or</p></li>
<li><p><strong>Categorical</strong> (e.g., gender, region, treatment vs.&nbsp;control).</p></li>
</ul>
<p><strong>Example of Moderation</strong></p>
<p>Imagine we are investigating whether the relationship between <strong>study hours</strong> (X) and <strong>test scores</strong> (Y) is moderated by <strong>sleep quality</strong> (W). It is possible that the effect of studying on test scores is stronger when sleep quality is high and weaker when sleep quality is low. This would suggest that sleep quality moderates the relationship between study hours and test scores.</p>
<p><br></p>
<p><strong>Moderation Formula</strong></p>
<p>The general form of a moderation model can be expressed as:</p>
<p><span class="math display">\[
Y = b_0 + b_1X + b_2W + b_3(X \times W)+e
\]</span></p>
<p>Where:</p>
<ul>
<li><p><strong>X</strong> is the independent variable,</p></li>
<li><p><strong>W</strong> is the moderator,</p></li>
<li><p><strong>XW</strong> is the interaction term between X and W, representing the moderation effect,</p></li>
<li><p><strong>b1</strong> represents the effect of X on Y (when W = 0),</p></li>
<li><p><strong>b2</strong> represents the effect of W on Y (when X = 0),</p></li>
<li><p><strong>b3</strong> represents <strong>the effect of the interaction</strong> between X and W on Y, quantifying how W moderates the effect of X on Y.</p></li>
</ul>
<p>In this model, the key coefficient of interest is <strong>b3</strong>, which tests whether the interaction between X and W significantly predicts Y. A significant interaction effect (b_3 ≠ 0) indicates the presence of moderation.</p>
<p><br></p>
</section>
<section id="decomposing-effects" class="level4">
<h4 class="anchored" data-anchor-id="decomposing-effects"><strong>Decomposing Effects</strong></h4>
<p>The interaction term captures how the effect of X on Y depends on W. Specifically:</p>
<p><span class="math display">\[
\text{Effect of X on Y} = \beta_1 + \beta_3 W
\]</span></p>
<p>When W increases, the slope of (X on Y) changes by <span class="math inline">\(\beta_3\)</span>​.</p>
<p><br></p>
</section>
<section id="conditional-effects" class="level4">
<h4 class="anchored" data-anchor-id="conditional-effects"><strong>Conditional Effects</strong></h4>
<p>The relationship between X and Y is <strong>conditional on the value of</strong> W</p>
<ul>
<li><p>If <span class="math inline">\(W=0\)</span>: The effect of X on Y is simply <span class="math inline">\(\beta_1\)</span></p></li>
<li><p>If <span class="math inline">\(W&gt;0\)</span>: The effect of X on Y becomes <span class="math inline">\(\beta_1+\beta_3W\)</span></p></li>
</ul>
<p>This demonstrates that the <strong>magnitude and direction</strong> of X’s effect on Y change depending on W.</p>
<p><br></p>
<p><strong>Path Diagram for Moderation</strong></p>
<p>A typical moderation model can be depicted as follows:</p>
<ul>
<li><p><strong>X → Y</strong>: The main effect of the independent variable (X) on the dependent variable (Y).</p></li>
<li><p><strong>W (Moderator)</strong>: The moderator affects the strength or direction of the X → Y relationship.</p></li>
<li><p><strong>Interaction Effect (X * W)</strong>: This term captures the effect of the interaction between X and W on Y. If the interaction term is significant, it indicates that W moderates the relationship between X and Y.</p></li>
</ul>
<p><br></p>
</section>
<section id="example-simple-moderation-using-hayes-model-1-in-r" class="level4">
<h4 class="anchored" data-anchor-id="example-simple-moderation-using-hayes-model-1-in-r"><strong>Example: Simple Moderation Using Hayes’ Model 1 in R</strong></h4>
<p>To illustrate moderation analysis, we will use <strong>Hayes’ Model 1</strong>, which tests for a simple moderation effect. In this example, we will examine whether <strong>motivation</strong> (W) moderates the relationship between <strong>hours studied</strong> (X) and <strong>test score</strong> (Y).</p>
<p><strong>Data Simulation Example</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating the dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)  <span class="co"># Hours studied (X)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)   <span class="co"># Motivation (Moderator, W)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="fl">0.6</span> <span class="sc">*</span> W <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> X <span class="sc">*</span> W <span class="sc">+</span> <span class="fu">rnorm</span>(n)  <span class="co"># Test score (Y)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">W =</span> W, <span class="at">Y =</span> Y)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          X        W        Y
1  8.879049 4.284758 18.60986
2  9.539645 4.247311 18.49225
3 13.117417 4.061461 23.63328
4 10.141017 3.947487 16.91829
5 10.258575 4.562840 21.67399
6 13.430130 5.331179 29.83955</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Running Moderation Analysis in R</strong></p>
<p>We can use the <code>lm()</code> function to fit the moderation model, including the interaction term between X and W.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Fit the main effects model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>main_effects_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">+</span> W, <span class="at">data =</span> data)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(main_effects_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X + W, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8798 -0.7630  0.0867  0.6989  4.1000 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -14.44599    0.50512  -28.60   &lt;2e-16 ***
X             1.84417    0.03499   52.71   &lt;2e-16 ***
W             3.59820    0.06692   53.77   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.142 on 297 degrees of freedom
Multiple R-squared:  0.9474,    Adjusted R-squared:  0.947 
F-statistic:  2673 on 2 and 297 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Fit the moderation model (including the interaction term)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>moderation_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">*</span> W, <span class="at">data =</span> data)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(moderation_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X * W, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.52213 -0.72725  0.04238  0.68765  2.63550 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.61640    1.77458  -0.347  0.72857    
X            0.48400    0.17158   2.821  0.00511 ** 
W            0.78321    0.35421   2.211  0.02779 *  
X:W          0.27753    0.03441   8.067 1.82e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.036 on 296 degrees of freedom
Multiple R-squared:  0.9568,    Adjusted R-squared:  0.9564 
F-statistic:  2188 on 3 and 296 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Interpreting the Results</strong></p>
<p>In the output of the <code>lm()</code> function, focus on the coefficient for the interaction term (<strong>X</strong>). If this term is significant, it means that motivation (W) moderates the relationship between hours studied (X) and test score (Y).</p>
<ul>
<li><p><strong>Main effects</strong>: The coefficients for <strong>X</strong> and <strong>W</strong> tell us the effect of hours studied and motivation on test scores when the other variable is held constant.</p></li>
<li><p><strong>Interaction effect</strong>: A significant interaction term indicates that the relationship between hours studied and test scores changes depending on the level of motivation.</p></li>
</ul>
<p>For example:</p>
<ul>
<li><p>If the interaction term is positive, the effect of study hours on test scores is stronger when motivation is higher.</p></li>
<li><p>If the interaction term is negative, the effect of study hours on test scores is weaker when motivation is higher.</p></li>
</ul>
<p><br></p>
<p><strong>Visualizing the Interaction Effect</strong></p>
<p>To better understand the moderation effect, it’s helpful to plot the interaction between X and W. The <code>interactions</code> package in R provides convenient functions for visualizing interaction effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the interactions package</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("interactions")</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the interaction effect</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(moderation_model, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">pred =</span> <span class="st">"X"</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">modx =</span> <span class="st">"W"</span>, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12_week_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows how the relationship between hours studied and test scores varies depending on the level of motivation. For example, you might see that at low levels of motivation, hours studied have little effect on test scores, but at high levels of motivation, hours studied have a strong positive effect on test scores.</p>
<p><br></p>
</section>
<section id="interpreting-the-results-of-moderation-analysis" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-the-results-of-moderation-analysis"><strong>Interpreting the Results of Moderation Analysis</strong></h4>
<p>Moderation analysis results need to be interpreted carefully to understand the underlying relationships. The significance of the interaction term helps determine whether moderation exists, and the direction of the interaction coefficient provides insight into how the moderator influences the relationship between X and Y.</p>
<ul>
<li><p><strong>Significant Interaction</strong>: If the interaction term is significant, W moderates the relationship between X and Y. The interaction plot provides a visual representation of this effect.</p></li>
<li><p><strong>Non-Significant Interaction</strong>: If the interaction term is not significant, this suggests that the relationship between X and Y is consistent across levels of W, meaning no moderation effect exists.</p></li>
<li><p><strong>Significant Interaction but Only One Main Effect is Significant:</strong> The significant interaction indicates that the effect of X on Y depends on W, even if X or W alone does not have a straightforward effect on Y.</p>
<ul>
<li><p>Example,</p>
<ul>
<li><p>Predictor (X): Study habits.</p></li>
<li><p>Moderator (W): Sleep quality.</p></li>
<li><p>Outcome (Y): Academic performance.</p></li>
</ul>
<p>If the main effect of W (sleep quality) is significant, but the main effect of X (study habits) is not, and the interaction (X×W) is significant:</p>
<ul>
<li><p><strong>Interpretation</strong>: Study habits do not independently predict academic performance, but their effect is <strong>moderated by sleep quality</strong>. For example:</p>
<ul>
<li><p>When sleep quality is high, study habits have a stronger positive impact on academic performance.</p></li>
<li><p>When sleep quality is low, the relationship between study habits and academic performance might weaken or even reverse.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><strong>Significant interaction, no main effects significant:</strong> The effect of X on Y exists <strong>only through interaction</strong> with W.</p></li>
</ul>
<p><br></p>
<p><strong>Simple Slopes Analysis</strong></p>
<p>To further interpret a significant moderation effect, a <strong>simple slopes analysis</strong> is often conducted. This involves examining the relationship between X and Y at different levels of the moderator (e.g., low, medium, and high levels of W).</p>
<p>The simple slopes analysis can provide insights into:</p>
<ul>
<li><p><strong>How the relationship between X and Y changes across levels of W</strong>.</p></li>
<li><p><strong>Whether the effect of X on Y is significant at different levels of W</strong>.</p></li>
</ul>
<p><br></p>
</section>
</section>
<section id="moderated-mediation-conditional-process" class="level3">
<h3 class="anchored" data-anchor-id="moderated-mediation-conditional-process"><strong>Moderated Mediation (Conditional Process)</strong></h3>
<p>Moderated mediation, also known as <strong>conditional process modeling</strong>, refers to the integration of both <strong>mediation</strong> and <strong>moderation</strong> in a single model. In a moderated mediation model, the indirect effect of an independent variable (X) on a dependent variable (Y) through a mediator (M) is contingent upon the level of a moderator (W). Let me explain the theoretical framework for moderated mediation, guide you through the steps for conducting such an analysis, and demonstrate how to perform this type of analysis in R using Hayes’ Model 7.</p>
<section id="conceptual-background-of-moderated-mediation" class="level4">
<h4 class="anchored" data-anchor-id="conceptual-background-of-moderated-mediation"><strong>Conceptual Background of Moderated Mediation</strong></h4>
<p>Moderated mediation explores both <u><strong>how</strong> and <strong>when</strong> an effect occurs</u>. Specifically, it investigates whether <u><strong>the strength or direction of the indirect effect of X on Y through M depends on a moderator variable (W)</strong></u>. This allows researchers to examine whether the mediation process varies across different conditions or groups.</p>
<p><br></p>
<p><strong>Key Questions Answered by Moderated Mediation</strong>:</p>
<ol type="1">
<li><p><strong>How does the mediation process work?</strong>: Does X affect Y through a mediator M?</p></li>
<li><p><strong>When or under what conditions is the mediation stronger or weaker?</strong>: Does the indirect effect of X on Y through M vary based on the level of a moderator W?</p></li>
</ol>
<p>Moderated mediation is particularly useful when a simple mediation model is not enough to capture the complexity of the relationships among variables. It allows researchers to test whether the mediation pathway is stronger or weaker under certain conditions.</p>
<p><br></p>
<p><strong>Path Diagram for Moderated Mediation</strong></p>
<p>A typical moderated mediation model can be represented as:</p>
<ul>
<li><p><strong>X → M → Y</strong>: This is the basic mediation pathway, where X affects Y indirectly through M.</p></li>
<li><p><strong>W moderating X → M</strong> or <strong>W moderating M → Y</strong>: The moderator W influences either the path from X to M (i.e., the indirect effect itself) or the path from M to Y.</p></li>
</ul>
<p>Thus, W can moderate the relationship between X and M, M and Y, or both.</p>
<p><strong>Moderated Mediation Formula</strong></p>
<p>The statistical model for moderated mediation can be expressed as follows:</p>
<ol type="1">
<li>For the mediator (M):</li>
</ol>
<p><span class="math display">\[
M = a_1X + a_2W + a_3(X \times W) + e_1
\]</span></p>
<ol start="2" type="1">
<li>For the dependent variable (Y):</li>
</ol>
<p><span class="math display">\[
Y = b_1M + b_2X + e_2
\]</span></p>
<p>Where:</p>
<ul>
<li><p><strong>a₁</strong>: The effect of X on M.</p></li>
<li><p><strong>a₃</strong>: The interaction between X and W, indicating whether W moderates the relationship between X and M.</p></li>
<li><p><strong>b₁</strong>: The effect of M on Y (mediated effect).</p></li>
</ul>
<p><br></p>
</section>
<section id="direct-effect" class="level4">
<h4 class="anchored" data-anchor-id="direct-effect">Direct Effect</h4>
<p>The direct effect of X on Y is independent of mediation: <span class="math inline">\(\beta_2\)</span></p>
</section>
<section id="indirect-effect" class="level4">
<h4 class="anchored" data-anchor-id="indirect-effect">Indirect Effect</h4>
<p>The <strong>indirect effect</strong> is conditional on the level of W, meaning that the mediation pathway (X → M → Y) changes depending on the moderator.</p>
<p><span class="math display">\[
\text{Indirect Effect}=(a_1+a_3W) \cdot b_1
\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(a_1\)</span>: Effect of X on M (baseline effect).</p></li>
<li><p><span class="math inline">\(a_3\)</span>​: Moderation of the X → M path by W.</p></li>
<li><p><span class="math inline">\(b_1\)</span>​: Effect of M on Y.</p></li>
</ul>
<p><br></p>
</section>
<section id="example-moderated-mediation-using-hayes-model-7-in-r" class="level4">
<h4 class="anchored" data-anchor-id="example-moderated-mediation-using-hayes-model-7-in-r"><strong>Example: Moderated Mediation Using Hayes’ Model 7 in R</strong></h4>
<p>Let’s work through an example of moderated mediation using <strong>Hayes’ Model 7</strong>, where we examine whether the indirect effect of <strong>hours studied</strong> (X) on <strong>test score</strong> (Y) through <strong>motivation</strong> (M) is moderated by <strong>interest in the subject</strong> (W).</p>
<p><strong>Data Simulation Example</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating the dataset</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)  <span class="co"># Hours studied (X)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)   <span class="co"># Interest in subject (Moderator, W)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> W <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> X <span class="sc">*</span> W <span class="sc">+</span> <span class="fu">rnorm</span>(n)  <span class="co"># Motivation (Mediating variable)</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> M <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(n)  <span class="co"># Test score (Dependent variable)</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">W =</span> W, <span class="at">M =</span> M, <span class="at">Y =</span> Y)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           X        W        M         Y
1   8.879049 7.198810 19.30933 15.323324
2   9.539645 6.312413 17.53853 13.357665
3  13.117417 4.734855 19.76623 15.761632
4  10.141017 5.543194 17.94735 12.294647
5  10.258575 4.585660 16.58415 13.818448
6  13.430130 4.523753 18.57256 14.961842
7  10.921832 4.211397 15.57382 11.964096
8   7.469878 4.405383 12.39449  8.265634
9   8.626294 6.650907 17.24415 12.634614
10  9.108676 4.945972 15.27567 11.048945</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Running Moderated Mediation Analysis in R</strong></p>
<p>We will use the <code>moderndive</code> package to estimate the moderated mediation model in R. In this example, the mediator is <strong>motivation</strong>, and the moderator is <strong>interest in the subject</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 필요한 패키지 설치 및 로드</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Fit the model for the mediator (X → M)</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>med_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(M <span class="sc">~</span> X <span class="sc">*</span> W, <span class="at">data =</span> data)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Fit the model for the outcome (Y ~ M + X * W)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>out_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X, <span class="at">data =</span> data)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Conduct the moderated mediation analysis</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>mod_med_analysis <span class="ot">&lt;-</span> <span class="fu">mediate</span>(med_model, </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                            out_model, </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">treat =</span> <span class="st">"X"</span>, </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mediator =</span> <span class="st">"M"</span>, </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">boot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sims =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running nonparametric bootstrap</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_med_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Causal Mediation Analysis 

Nonparametric Bootstrap Confidence Intervals with the Percentile Method

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME              0.940        0.824         1.04  &lt;2e-16 ***
ADE               0.229        0.107         0.35  &lt;2e-16 ***
Total Effect      1.169        1.065         1.26  &lt;2e-16 ***
Prop. Mediated    0.804        0.711         0.90  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Sample Size Used: 200 


Simulations: 500 </code></pre>
</div>
</div>
<p><br></p>
<p><strong>Conditional mediation effect analysis</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># W의 값 설정 (평균, 평균 ± 1표준편차)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>W_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>W) <span class="sc">-</span> <span class="fu">sd</span>(data<span class="sc">$</span>W), </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mean</span>(data<span class="sc">$</span>W), </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mean</span>(data<span class="sc">$</span>W) <span class="sc">+</span> <span class="fu">sd</span>(data<span class="sc">$</span>W))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>W_levels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.046200 5.042121 6.038042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 기존 모델에서 계수 추출</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>med_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(med_model)  </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>out_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(out_model)  </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 간접효과 계산</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>indirect_effects <span class="ot">&lt;-</span> <span class="fu">sapply</span>(W_levels, <span class="cf">function</span>(w) {</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 간접효과 = (beta_X + beta_X:W * W) * gamma_M</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  (med_coefs[<span class="st">"X"</span>] <span class="sc">+</span> med_coefs[<span class="st">"X:W"</span>] <span class="sc">*</span> w) <span class="sc">*</span> out_coefs[<span class="st">"M"</span>]</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(indirect_effects) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Low W"</span>, <span class="st">"Mean W"</span>, <span class="st">"High W"</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(indirect_effects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Low W    Mean W    High W 
0.8102705 0.9398953 1.0695201 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 데이터프레임 생성</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>indirect_effects_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">W_level =</span> <span class="fu">c</span>(<span class="st">"Low W"</span>, <span class="st">"Mean W"</span>, <span class="st">"High W"</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Indirect_Effect =</span> indirect_effects</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>indirect_effects_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       W_level Indirect_Effect
Low W    Low W       0.8102705
Mean W  Mean W       0.9398953
High W  High W       1.0695201</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 부트스트랩 샘플링 함수 정의</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>bootstrap_indirect_effect <span class="ot">&lt;-</span> <span class="cf">function</span>(data, W_value, <span class="at">n_boot =</span> <span class="dv">5000</span>) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  boot_results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_boot, {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 샘플 재추출</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    sample_data <span class="ot">&lt;-</span> data[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 매개변수 모델</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    med_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(M <span class="sc">~</span> X <span class="sc">*</span> W, <span class="at">data =</span> sample_data)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    med_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(med_model)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 결과 변수 모델</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    out_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X, <span class="at">data =</span> sample_data)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    out_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(out_model)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 간접효과 계산</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    indirect_effect <span class="ot">&lt;-</span> (med_coefs[<span class="st">"X"</span>] <span class="sc">+</span> med_coefs[<span class="st">"X:W"</span>] <span class="sc">*</span> W_value) <span class="sc">*</span> out_coefs[<span class="st">"M"</span>]</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(indirect_effect)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 평균 및 신뢰구간 계산</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  mean_effect <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_results, <span class="fl">0.025</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_results, <span class="fl">0.975</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(mean_effect, ci_lower, ci_upper))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co"># W 값 설정</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>W_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(data<span class="sc">$</span>W) <span class="sc">-</span> <span class="fu">sd</span>(data<span class="sc">$</span>W), <span class="fu">mean</span>(data<span class="sc">$</span>W), <span class="fu">mean</span>(data<span class="sc">$</span>W) <span class="sc">+</span> <span class="fu">sd</span>(data<span class="sc">$</span>W))</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>W_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Low W"</span>, <span class="st">"Mean W"</span>, <span class="st">"High W"</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 W 수준에서 간접효과 계산</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>indirect_results <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(W_levels, <span class="cf">function</span>(w) <span class="fu">bootstrap_indirect_effect</span>(data, w)))</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(indirect_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Effect"</span>, <span class="st">"CI_Lower"</span>, <span class="st">"CI_Upper"</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>indirect_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">W_Level =</span> W_labels, indirect_results)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>indirect_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  W_Level    Effect  CI_Lower  CI_Upper
1   Low W 0.8105840 0.7040393 0.9224319
2  Mean W 0.9414754 0.8352290 1.0516849
3  High W 1.0718155 0.9442989 1.1969065</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 간접효과 시각화</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(indirect_results, <span class="fu">aes</span>(<span class="at">x =</span> W_Level, <span class="at">y =</span> Effect)) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Point 표시</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_Lower, <span class="at">ymax =</span> CI_Upper), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Error bar 추가</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Conditional Indirect Effects by Moderator Levels (W)"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Moderator Levels (W)"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indirect Effect"</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span>  <span class="co"># Minimal theme</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12_week_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ChangjunChrisLee/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Dr_CJLee">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>